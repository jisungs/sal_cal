# Sample 폴더 엑셀 템플릿 파일 상세 분석

**작성일**: 2025-12-12  
**분석 대상**: `sample/` 폴더의 엑셀 템플릿 파일

---

## 📁 파일 목록 및 기본 정보

| 파일명 | 크기 | 형식 | 용도 |
|--------|------|------|------|
| 급여명세서_template.xlsx | 13KB | Excel 2007+ | 급여명세서 생성용 템플릿 |
| 임금명세서양식_template3.xlsx | 14KB | Excel 2007+ | 임금명세서 양식 (법적 요구사항 준수) |

---

## 📋 파일별 상세 분석

### 1. 급여명세서_template.xlsx

#### 1.1 파일 정보
- **크기**: 13KB
- **형식**: Microsoft Excel 2007+ (.xlsx)
- **용도**: 급여명세서 생성용 템플릿 파일

#### 1.2 예상 구조 (프로젝트 코드 기반 추정)

현재 프로젝트의 `excel_handler.py`에서 사용하는 템플릿 파일(`payroll_template.xlsx`)과 유사한 구조로 추정됩니다.

**예상 레이아웃**:

```
┌─────────────────────────────────────────┐
│  급여명세서                              │  ← 제목 (A1 또는 병합된 셀)
│  지급기간: 2025-01                      │  ← 기간 (A2 또는 B2)
├─────────────────────────────────────────┤
│  직원 정보                               │
│  성명: [이름]                           │  ← 이름 (예: B4)
│  주민번호: [주민번호]                   │  ← 주민번호 (예: B5)
│  입사일: [입사일]                       │  ← 입사일 (예: B6)
├─────────────────────────────────────────┤
│  지급 항목                               │
│  기본급: [금액]                         │  ← 기본급 (예: C8)
│  연장근무수당: [금액]                   │  ← 연장근무수당 (예: C9)
│  상여금: [금액]                         │  ← 상여금 (예: C10)
│  총 지급액: [금액]                      │  ← 총 지급액 (예: C11)
├─────────────────────────────────────────┤
│  공제 항목                               │
│  국민연금: [금액]                       │  ← 국민연금 (예: C13)
│  건강보험: [금액]                       │  ← 건강보험 (예: C14)
│  장기요양: [금액]                       │  ← 장기요양 (예: C15)
│  고용보험: [금액]                       │  ← 고용보험 (예: C16)
│  소득세: [금액]                         │  ← 소득세 (예: C17)
│  지방소득세: [금액]                     │  ← 지방소득세 (예: C18)
│  총 공제액: [금액]                      │  ← 총 공제액 (예: C19)
├─────────────────────────────────────────┤
│  실수령액: [금액]                       │  ← 실수령액 (예: C21)
└─────────────────────────────────────────┘
```

#### 1.3 현재 프로젝트와의 관계

**현재 프로젝트에서 사용 중인 템플릿**:
- `payroll_generator/templates/payroll_template.xlsx`
- `excel_handler.py`의 `_write_payroll_from_template()` 메서드에서 사용

**관계**:
- `sample/급여명세서_template.xlsx`는 참고용 템플릿일 가능성이 높음
- 현재 프로젝트의 `payroll_template.xlsx`와 구조가 유사할 것으로 추정
- 디자인 선택 기능과는 별개로 사용되는 템플릿

#### 1.4 분석 필요 사항

다음 정보를 확인하기 위해 엑셀 파일을 직접 열어야 합니다:

1. **셀 매핑 정보**
   - 각 데이터가 채워질 정확한 셀 위치
   - 병합된 셀 정보
   - 수식이 있는 셀

2. **스타일 정보**
   - 폰트 (이름, 크기, 굵게/일반)
   - 배경색
   - 테두리
   - 정렬 방식

3. **데이터 형식**
   - 날짜 형식
   - 숫자 형식 (통화 형식 등)
   - 텍스트 형식

---

### 2. 임금명세서양식_template3.xlsx

#### 2.1 파일 정보
- **크기**: 14KB
- **형식**: Microsoft Excel 2007+ (.xlsx)
- **용도**: 임금명세서 양식 (법적 요구사항 준수)

#### 2.2 법적 요구사항 (임금명세서작성방법.md 참고)

**필수 포함 항목**:

1. **임금 항목과 지급액**
   - 매월 지급하는 임금
   - 격월 또는 부정기적으로 지급하는 임금 (명절상여금, 하계휴가비 등)

2. **공제 항목과 공제액**
   - 법령이나 단체협약에 따라 임금의 일부를 공제하는 경우
   - 항목과 금액 기재
   - 근로소득세율, 사회보험요율은 계산방법 기재 불필요

3. **계산 방법**
   - 시간급·일급, 연장·야간·휴일근로수당 등
   - 출근일수·시간 수 등에 따라 금액이 달라지는 임금항목
   - 예: '18일(근로일수)x7,000원'

4. **연장·야간·휴일근로수당 상세 정보**
   - 실제 근로한 연장·야간·휴일 근로시간 수
   - 통상시급
   - 가산율이 명시된 계산방법
   - 예: 연장근로수당 288,000원 = 16시간 X 12,000원 X 1.5

#### 2.3 예상 구조

**예상 레이아웃**:

```
┌─────────────────────────────────────────┐
│  임금명세서                              │  ← 제목
│  지급기간: [기간]                       │
├─────────────────────────────────────────┤
│  직원 정보                               │
│  성명: [이름]                           │
│  주민번호: [주민번호]                   │
│  입사일: [입사일]                       │
├─────────────────────────────────────────┤
│  임금 항목 및 지급액                     │
│  기본급: [금액]                         │
│  연장근로수당: [금액]                   │
│    계산방법: [시간] X [시급] X [가산율] │  ← 계산 방법 기재
│  야간근로수당: [금액]                   │
│    계산방법: [시간] X [시급] X [가산율] │
│  휴일근로수당: [금액]                   │
│    계산방법: [시간] X [시급] X [가산율] │
│  상여금: [금액]                         │
│  총 지급액: [금액]                      │
├─────────────────────────────────────────┤
│  공제 항목 및 공제액                     │
│  국민연금: [금액]                       │
│  건강보험: [금액]                       │
│  장기요양: [금액]                       │
│  고용보험: [금액]                       │
│  소득세: [금액]                         │
│  지방소득세: [금액]                     │
│  총 공제액: [금액]                      │
├─────────────────────────────────────────┤
│  실수령액: [금액]                       │
└─────────────────────────────────────────┘
```

#### 2.4 현재 프로젝트와의 관계

**차이점**:
- 현재 프로젝트는 기본적인 급여명세서 생성에 중점
- 이 템플릿은 법적 요구사항을 더 상세히 반영 (계산 방법 기재 등)

**활용 가능성**:
- 향후 법적 요구사항을 더 충실히 반영한 버전 개발 시 참고
- 계산 방법 자동 생성 기능 추가 시 활용 가능

---

## 🔍 상세 분석 방법

### 방법 1: Python 스크립트 사용 (권장)

다음 스크립트를 실행하여 상세 분석:

```bash
# openpyxl 설치 (가상환경 사용 시)
pip install openpyxl

# 분석 스크립트 실행
python3 scripts/analyze_sample_templates.py
```

**분석 항목**:
- 시트 구조 및 이름
- 데이터 샘플 (첫 20행)
- 병합된 셀 정보
- 스타일 정보 (폰트, 배경색, 정렬)
- 수식 정보

### 방법 2: 엑셀 프로그램으로 직접 열기

Microsoft Excel 또는 LibreOffice Calc로 파일을 열어:
- 레이아웃 확인
- 셀 위치 확인
- 스타일 확인
- 수식 확인

### 방법 3: 코드에서 사용 중인 템플릿과 비교

현재 프로젝트의 `payroll_generator/templates/payroll_template.xlsx`와 비교:
- 구조 차이점 확인
- 셀 매핑 차이점 확인
- 스타일 차이점 확인

---

## 💡 프로젝트 통합 검토

### 현재 프로젝트 구조

**템플릿 파일 위치**:
- `payroll_generator/templates/payroll_template.xlsx`: 현재 사용 중인 템플릿
- `payroll_generator/templates/employee_template.xlsx`: 직원 정보 입력 템플릿
- `payroll_generator/templates/company_template.xlsx`: 회사 정보 템플릿

**디자인 선택 기능**:
- `design_1.py`, `design_2.py`: YAML 설정 기반 직접 생성
- 엑셀 템플릿 기반 생성은 `use_template=True`일 때 사용

### Sample 폴더 템플릿의 활용 방안

1. **참고 자료로 활용**
   - 레이아웃 참고
   - 스타일 참고
   - 셀 매핑 참고

2. **새로운 디자인 템플릿으로 활용**
   - `design_3` 등 추가 디자인으로 활용 가능
   - YAML 설정 파일 작성 시 참고

3. **법적 요구사항 반영**
   - `임금명세서양식_template3.xlsx`의 계산 방법 기재 방식 참고
   - 향후 계산 방법 자동 생성 기능 추가 시 활용

---

## 📝 다음 단계

1. **엑셀 파일 직접 분석**
   - 파일을 열어 상세 구조 확인
   - 셀 매핑 정보 수집
   - 스타일 정보 수집

2. **프로젝트 통합 검토**
   - 현재 템플릿 파일과의 비교
   - 디자인 선택 기능과의 연관성 확인

3. **문서화**
   - 템플릿 파일 구조 문서화
   - 셀 매핑 정보 문서화
   - 사용 방법 가이드 작성

---

## 📚 관련 문서

- `sample/임금명세서작성방법.md`: 법적 요구사항 상세 설명
- `plan/2025-12-12/엑셀_템플릿_제작_가이드.md`: 템플릿 제작 가이드
- `payroll_generator/excel_handler.py`: 엑셀 생성 로직

---

**참고**: 
- 엑셀 파일을 직접 열어 상세 분석을 수행하는 것이 가장 정확합니다.
- `scripts/analyze_sample_templates.py` 스크립트를 실행하면 자동으로 분석할 수 있습니다 (openpyxl 설치 필요).
