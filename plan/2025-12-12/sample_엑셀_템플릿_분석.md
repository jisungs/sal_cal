# Sample 폴더 엑셀 템플릿 파일 분석

**작성일**: 2025-12-12  
**분석 대상**: `sample/` 폴더의 엑셀 템플릿 파일

---

## 📁 파일 목록

`sample/` 폴더에 있는 파일들:

1. **급여명세서_template.xlsx**
   - 급여명세서 템플릿 파일

2. **임금명세서양식_template3.xlsx**
   - 임금명세서 양식 템플릿 파일 (버전 3)

3. **임금명세서작성방법.md**
   - 임금명세서 작성 방법 가이드 문서

---

## 📋 파일 분석

### 1. 급여명세서_template.xlsx

**용도**: 급여명세서 생성용 템플릿 파일

**예상 구조**:
- 제목 영역: "급여명세서"
- 직원 정보 영역: 이름, 주민번호, 입사일 등
- 지급 항목 영역: 기본급, 연장근무수당, 상여금, 총 지급액
- 공제 항목 영역: 국민연금, 건강보험, 장기요양, 고용보험, 소득세, 지방소득세, 총 공제액
- 실수령액 영역: 최종 실수령액

**현재 프로젝트에서의 사용**:
- `payroll_generator/excel_handler.py`의 `_write_payroll_from_template()` 메서드에서 사용
- 템플릿 경로: `payroll_generator/templates/payroll_template.xlsx`
- `use_template=True`일 때 이 템플릿을 사용하여 급여명세서 생성

### 2. 임금명세서양식_template3.xlsx

**용도**: 임금명세서 양식 템플릿 파일 (법적 요구사항 준수)

**예상 구조** (임금명세서작성방법.md 참고):
- 임금 항목과 지급액
- 공제 항목과 공제액
- 계산 방법 (시간급·일급, 연장·야간·휴일근로수당 등)
- 연장·야간·휴일근로수당 상세 정보

**법적 요구사항**:
- 매월 지급하는 임금 및 격월/부정기 지급 임금 기재
- 법령이나 단체협약에 따른 공제 항목과 금액 기재
- 시간급·일급, 연장·야간·휴일근로수당의 계산 방법 기재
- 연장·야간·휴일근로수당의 실제 근로시간, 통상시급, 가산율 명시

---

## 🔍 상세 분석 필요 사항

다음 정보를 확인하기 위해 엑셀 파일을 직접 열어 분석해야 합니다:

### 급여명세서_template.xlsx 분석 항목

1. **시트 구조**
   - 시트 개수 및 이름
   - 각 시트의 용도

2. **레이아웃 구조**
   - 제목 영역 위치 (행/열)
   - 직원 정보 영역 위치
   - 지급 항목 영역 위치
   - 공제 항목 영역 위치
   - 실수령액 영역 위치

3. **셀 매핑**
   - 각 데이터가 채워질 셀 위치
   - 병합된 셀 정보
   - 수식이 있는 셀

4. **스타일 정보**
   - 폰트 (이름, 크기, 굵게/일반)
   - 배경색
   - 테두리
   - 정렬 방식

5. **데이터 형식**
   - 날짜 형식
   - 숫자 형식 (통화 형식 등)
   - 텍스트 형식

### 임금명세서양식_template3.xlsx 분석 항목

1. **법적 요구사항 준수 여부**
   - 필수 항목 포함 여부
   - 계산 방법 기재 방식
   - 연장·야간·휴일근로수당 상세 정보 표시 방식

2. **레이아웃 구조**
   - 임금 항목 영역
   - 공제 항목 영역
   - 계산 방법 영역

3. **현재 프로젝트와의 호환성**
   - 현재 프로젝트의 데이터 구조와 매핑 가능 여부
   - 추가 개발이 필요한 부분

---

## 💡 권장 사항

### 1. 엑셀 파일 직접 분석

다음 방법으로 상세 분석을 수행할 수 있습니다:

**방법 1: Python 스크립트 사용**
```python
import openpyxl
import pandas as pd

# 파일 로드
wb = openpyxl.load_workbook('sample/급여명세서_template.xlsx')

# 시트 정보
print("시트:", wb.sheetnames)

# 각 시트 분석
for sheet_name in wb.sheetnames:
    ws = wb[sheet_name]
    print(f"\n시트: {sheet_name}")
    print(f"크기: {ws.max_row}행 x {ws.max_column}열")
    
    # 데이터 샘플
    for row in ws.iter_rows(min_row=1, max_row=20, values_only=True):
        print(row)
```

**방법 2: 엑셀 프로그램으로 직접 열기**
- Microsoft Excel 또는 LibreOffice Calc로 파일 열기
- 레이아웃, 스타일, 셀 위치 확인
- 수식 및 병합된 셀 확인

### 2. 프로젝트 통합 검토

현재 프로젝트에서:
- `payroll_generator/templates/payroll_template.xlsx`를 사용 중
- `sample/급여명세서_template.xlsx`와의 관계 확인 필요
- 디자인 선택 기능과의 연관성 확인 필요

### 3. 디자인 선택 기능과의 연관성

현재 구현된 디자인 선택 기능:
- `design_1.py`, `design_2.py`: YAML 설정 기반 직접 생성
- 엑셀 템플릿 기반 생성은 `use_template=True`일 때 사용

**고려 사항**:
- `sample/` 폴더의 템플릿 파일들이 디자인 선택 기능에 활용 가능한지
- 새로운 디자인 템플릿으로 사용 가능한지
- 기존 템플릿과의 호환성

---

## 📝 다음 단계

1. **엑셀 파일 직접 분석**
   - 파일을 열어 상세 구조 확인
   - 셀 매핑 정보 수집
   - 스타일 정보 수집

2. **프로젝트 통합 검토**
   - 현재 템플릿 파일과의 비교
   - 디자인 선택 기능과의 연관성 확인

3. **문서화**
   - 템플릿 파일 구조 문서화
   - 사용 방법 가이드 작성

---

**참고**: 
- `임금명세서작성방법.md` 파일에 법적 요구사항이 상세히 설명되어 있음
- 현재 프로젝트는 `payroll_generator/templates/payroll_template.xlsx`를 사용 중
