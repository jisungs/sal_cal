# 다음 단계 작업 가이드 - 템플릿 디자인

**작성일**: 2025-12-12  
**상태**: ✅ 기본 구현 완료, 검증 필요

---

## ✅ 완료된 작업

### Phase 0-4 완료
- [x] 템플릿 파일 복사 및 분석 스크립트 생성
- [x] TemplateDesign 기본 클래스 구현
- [x] TemplateSample1, TemplateSample2 클래스 구현
- [x] DesignFactory에 템플릿 디자인 등록
- [x] 웹/데스크톱 UI 업데이트
- [x] 단위 테스트 및 통합 테스트 작성

---

## 🔍 다음 단계: 셀 매핑 검증 및 테스트

### 1단계: 필요한 패키지 설치

```bash
# 프로젝트 루트에서 실행
pip install -r requirements.txt

# 또는 개별 설치
pip install openpyxl PyYAML
```

### 2단계: 템플릿 분석 (선택사항)

자동 분석 스크립트를 사용하여 셀 매핑 생성:

```bash
# 템플릿 1 분석
python scripts/analyze_template_cells.py \
    payroll_generator/templates/designs/template_sample1.xlsx \
    payroll_generator/templates/designs/configs/template_sample1_mapping.json

# 템플릿 2 분석
python scripts/analyze_template_cells.py \
    payroll_generator/templates/designs/template_sample2.xlsx \
    payroll_generator/templates/designs/configs/template_sample2_mapping.json
```

### 3단계: 셀 매핑 수동 검증 (권장)

1. **템플릿 파일 열기**
   - `payroll_generator/templates/designs/template_sample1.xlsx` 엑셀로 열기
   - 각 데이터 항목의 실제 셀 위치 확인

2. **셀 매핑 JSON 파일 수정**
   - `payroll_generator/templates/designs/configs/template_sample1_mapping.json` 열기
   - 확인한 셀 위치로 수정

3. **템플릿 2도 동일하게 진행**

### 4단계: 실제 생성 테스트

```bash
# 테스트 스크립트 실행
python scripts/test_template_generation.py
```

생성된 파일을 엑셀로 열어서 다음을 확인:
- [ ] 이름이 올바른 위치에 있는가?
- [ ] 주민번호가 올바른 위치에 있는가?
- [ ] 기본급, 실수령액 등이 올바른 위치에 있는가?

### 5단계: 웹/데스크톱 인터페이스에서 테스트

1. **웹 인터페이스**:
   - 브라우저에서 애플리케이션 실행
   - 디자인 선택에서 "템플릿 1: 급여명세서" 선택
   - 샘플 데이터로 급여명세서 생성
   - 생성된 파일 확인

2. **데스크톱 인터페이스**:
   - `python main.py` 실행
   - 디자인 선택에서 `template_sample1` 선택
   - 샘플 데이터로 급여명세서 생성
   - 생성된 파일 확인

---

## 📋 상세 가이드

자세한 내용은 다음 문서를 참조하세요:

- **셀 매핑 검증 가이드**: `plan/2025-12-12/템플릿_셀_매핑_검증_가이드.md`
- **완료 보고서**: `plan/2025-12-12/템플릿_디자인_통합_완료_보고서.md`
- **실행 계획**: `plan/2025-12-12/sample_템플릿_기본_디자인_통합_실행계획_v2.md`

---

## ⚠️ 중요 사항

### 셀 매핑 정확성
현재 셀 매핑은 기본값으로 설정되어 있습니다. 실제 템플릿 파일의 셀 구조에 맞게 수정해야 정확한 결과를 얻을 수 있습니다.

### 기본 매핑 사용
셀 매핑 JSON 파일이 없거나 비어있으면 기본 매핑(`_fill_with_default_mapping`)이 사용됩니다. 이는 기존 `_write_payroll_from_template`과 동일한 셀 위치를 사용합니다.

---

## 🎯 완료 기준

템플릿 디자인 통합이 완료되었다고 볼 수 있는 기준:

- [x] 코드 구현 완료
- [x] UI 업데이트 완료
- [ ] 셀 매핑 검증 완료
- [ ] 실제 생성 테스트 완료
- [ ] 생성된 파일 검증 완료

---

**작성자**: AI Assistant  
**작성일**: 2025-12-12
