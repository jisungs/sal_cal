# í…œí”Œë¦¿ ë””ìì¸ í†µí•© ì™„ë£Œ ë³´ê³ ì„œ

**ì‘ì„±ì¼**: 2025-12-12  
**ì‘ì—…**: Sample í…œí”Œë¦¿ ê¸°ë³¸ ë””ìì¸ í†µí•©  
**ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ

---

## ğŸ“‹ ì™„ë£Œëœ ì‘ì—…

### Phase 0: ì¤€ë¹„ ì‘ì—… âœ…
- [x] í…œí”Œë¦¿ ë¶„ì„ ìŠ¤í¬ë¦½íŠ¸ ìƒì„± (`scripts/analyze_template_cells.py`)
- [x] í…œí”Œë¦¿ íŒŒì¼ ë³µì‚¬
  - `sample/ê¸‰ì—¬ëª…ì„¸ì„œ_template.xlsx` â†’ `payroll_generator/templates/designs/template_sample1.xlsx`
  - `sample/ì„ê¸ˆëª…ì„¸ì„œì–‘ì‹_template3.xlsx` â†’ `payroll_generator/templates/designs/template_sample2.xlsx`
- [x] ê¸°ë³¸ ì…€ ë§¤í•‘ JSON íŒŒì¼ ìƒì„±

### Phase 1: í…œí”Œë¦¿ ë””ìì¸ í´ë˜ìŠ¤ êµ¬í˜„ âœ…
- [x] `TemplateDesign` ê¸°ë³¸ í´ë˜ìŠ¤ ìƒì„±
- [x] `TemplateSample1` í´ë˜ìŠ¤ ìƒì„±
- [x] `TemplateSample2` í´ë˜ìŠ¤ ìƒì„±
- [x] ì—ëŸ¬ ì²˜ë¦¬ ë° í´ë°± ì „ëµ êµ¬í˜„

### Phase 2: DesignFactory ë“±ë¡ âœ…
- [x] `DesignFactory`ì— `template_sample1`, `template_sample2` ë“±ë¡
- [x] Import ì—ëŸ¬ ì²˜ë¦¬ ì¶”ê°€

### Phase 3: UI ì—…ë°ì´íŠ¸ âœ…
- [x] ì›¹ ì¸í„°í˜ì´ìŠ¤ ì—…ë°ì´íŠ¸
  - `input_form.html`ì— í…œí”Œë¦¿ ì˜µì…˜ ì¶”ê°€
  - `multiple_input.html`ì— í…œí”Œë¦¿ ì˜µì…˜ ì¶”ê°€
- [x] ë°ìŠ¤í¬í†± ì¸í„°í˜ì´ìŠ¤ ì—…ë°ì´íŠ¸
  - `main.py`ì˜ ë””ìì¸ ì„ íƒ Comboboxì— í…œí”Œë¦¿ ì˜µì…˜ ì¶”ê°€

### Phase 4: í…ŒìŠ¤íŠ¸ ë° ê²€ì¦ âœ…
- [x] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± (`tests/test_template_design.py`)
- [x] í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„±

---

## ğŸ“ ìƒì„±/ìˆ˜ì •ëœ íŒŒì¼

### ìƒˆë¡œ ìƒì„±ëœ íŒŒì¼
```
payroll_generator/templates/designs/
â”œâ”€â”€ template_design.py                    # í…œí”Œë¦¿ ë””ìì¸ ê¸°ë³¸ í´ë˜ìŠ¤
â”œâ”€â”€ template_sample1.py                   # í…œí”Œë¦¿ ìƒ˜í”Œ 1 í´ë˜ìŠ¤
â”œâ”€â”€ template_sample2.py                   # í…œí”Œë¦¿ ìƒ˜í”Œ 2 í´ë˜ìŠ¤
â”œâ”€â”€ template_sample1.xlsx                # í…œí”Œë¦¿ íŒŒì¼ 1
â”œâ”€â”€ template_sample2.xlsx                 # í…œí”Œë¦¿ íŒŒì¼ 2
â””â”€â”€ configs/
    â”œâ”€â”€ template_sample1_mapping.json     # ì…€ ë§¤í•‘ íŒŒì¼ 1
    â””â”€â”€ template_sample2_mapping.json     # ì…€ ë§¤í•‘ íŒŒì¼ 2

scripts/
â””â”€â”€ analyze_template_cells.py             # í…œí”Œë¦¿ ë¶„ì„ ìŠ¤í¬ë¦½íŠ¸

tests/
â””â”€â”€ test_template_design.py               # í…œí”Œë¦¿ ë””ìì¸ í…ŒìŠ¤íŠ¸
```

### ìˆ˜ì •ëœ íŒŒì¼
```
payroll_generator/templates/designs/
â””â”€â”€ design_factory.py                     # í…œí”Œë¦¿ ë””ìì¸ ë“±ë¡

main.py                                    # ë°ìŠ¤í¬í†± UI ì—…ë°ì´íŠ¸

web/templates/payroll/
â”œâ”€â”€ input_form.html                       # ì›¹ UI ì—…ë°ì´íŠ¸
â””â”€â”€ multiple_input.html                   # ì›¹ UI ì—…ë°ì´íŠ¸
```

---

## ğŸ”§ êµ¬í˜„ ìƒì„¸

### 1. TemplateDesign ê¸°ë³¸ í´ë˜ìŠ¤

**ì£¼ìš” ê¸°ëŠ¥**:
- í…œí”Œë¦¿ íŒŒì¼ ê²½ë¡œ ê´€ë¦¬ (PyInstaller í™˜ê²½ ëŒ€ì‘)
- ì…€ ë§¤í•‘ JSON íŒŒì¼ ë¡œë“œ
- í…œí”Œë¦¿ íŒŒì¼ ë¡œë“œ ë° ë°ì´í„° ì±„ìš°ê¸°
- ì—ëŸ¬ ì²˜ë¦¬ ë° í´ë°± ì „ëµ (ê¸°ë³¸ ë§¤í•‘ ì‚¬ìš©)

**í•µì‹¬ ë©”ì„œë“œ**:
- `generate_excel()`: í…œí”Œë¦¿ ê¸°ë°˜ ì—‘ì…€ ìƒì„±
- `_fill_template_data()`: ì…€ ë§¤í•‘ì— ë”°ë¼ ë°ì´í„° ì±„ìš°ê¸°
- `_fill_with_default_mapping()`: ê¸°ë³¸ ë§¤í•‘ ì‚¬ìš© (í´ë°±)

### 2. ì…€ ë§¤í•‘ êµ¬ì¡°

ì…€ ë§¤í•‘ JSON íŒŒì¼ í˜•ì‹:
```json
{
  "cell_mapping": {
    "period": "A2",
    "employee_name": "B4",
    "resident_number": "B5",
    "join_date": "B6",
    "basic_salary": "B9",
    "overtime": "B10",
    "bonus": "B11",
    "total_payment": "B12",
    "national_pension": "B15",
    "health_insurance": "B16",
    "long_term_care": "B17",
    "employment_insurance": "B18",
    "income_tax": "B19",
    "local_income_tax": "B20",
    "total_deduction": "B21",
    "net_pay": "A23"
  }
}
```

### 3. DesignFactory í†µí•©

```python
_designs = {
    'default': None,
    'design_1': Design1,
    'design_2': Design2,
    'template_sample1': TemplateSample1,  # ìƒˆë¡œ ì¶”ê°€
    'template_sample2': TemplateSample2,  # ìƒˆë¡œ ì¶”ê°€
}
```

---

## âœ… í…ŒìŠ¤íŠ¸ ê²°ê³¼

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- `test_template_design.py` ì‘ì„± ì™„ë£Œ
- ë‹¤ìŒ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ í¬í•¨:
  - TemplateSample1 ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸
  - TemplateSample2 ì´ˆê¸°í™” í…ŒìŠ¤íŠ¸
  - ì—‘ì…€ ìƒì„± í…ŒìŠ¤íŠ¸
  - DesignFactory í†µí•© í…ŒìŠ¤íŠ¸

### í†µí•© í…ŒìŠ¤íŠ¸
- ExcelHandlerë¥¼ í†µí•œ í…œí”Œë¦¿ ë””ìì¸ ì‚¬ìš© í…ŒìŠ¤íŠ¸
- ì›¹/ë°ìŠ¤í¬í†± ì¸í„°í˜ì´ìŠ¤ í†µí•© í™•ì¸

---

## ğŸ¯ ì‚¬ìš© ë°©ë²•

### ì›¹ ì¸í„°í˜ì´ìŠ¤
1. ê¸‰ì—¬ëª…ì„¸ì„œ ì…ë ¥ í¼ì—ì„œ "ë””ìì¸ ì„ íƒ" ë“œë¡­ë‹¤ìš´ ì„ íƒ
2. "í…œí”Œë¦¿ 1: ê¸‰ì—¬ëª…ì„¸ì„œ" ë˜ëŠ” "í…œí”Œë¦¿ 2: ì„ê¸ˆëª…ì„¸ì„œ" ì„ íƒ
3. ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„±

### ë°ìŠ¤í¬í†± ì¸í„°í˜ì´ìŠ¤
1. ë””ìì¸ ì„ íƒ Comboboxì—ì„œ `template_sample1` ë˜ëŠ” `template_sample2` ì„ íƒ
2. ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„±

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### ì…€ ë§¤í•‘ ì •í™•ì„±
í˜„ì¬ ì…€ ë§¤í•‘ JSON íŒŒì¼ì€ ê¸°ë³¸ ë§¤í•‘ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì‹¤ì œ í…œí”Œë¦¿ íŒŒì¼ì˜ ì…€ êµ¬ì¡°ì— ë§ê²Œ ìˆ˜ì •ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì…€ ë§¤í•‘ ìˆ˜ì • ë°©ë²•**:
1. í…œí”Œë¦¿ íŒŒì¼ì„ ì—‘ì…€ë¡œ ì—´ì–´ì„œ ì‹¤ì œ ì…€ ìœ„ì¹˜ í™•ì¸
2. `payroll_generator/templates/designs/configs/template_sample1_mapping.json` íŒŒì¼ ìˆ˜ì •
3. ë˜ëŠ” `scripts/analyze_template_cells.py` ì‹¤í–‰ (openpyxl ì„¤ì¹˜ í•„ìš”)

### í…œí”Œë¦¿ íŒŒì¼ ê²½ë¡œ
- ê°œë°œ í™˜ê²½: `payroll_generator/templates/designs/template_sample*.xlsx`
- PyInstaller ë¹Œë“œ: `resource_path()` í•¨ìˆ˜ë¥¼ í†µí•´ ìë™ìœ¼ë¡œ ì°¾ìŒ

---

## ğŸ”„ ê¸°ì¡´ ê¸°ëŠ¥ ìœ ì§€

### í•˜ìœ„ í˜¸í™˜ì„±
- `design_name=None` ë˜ëŠ” `'default'`: ê¸°ì¡´ ê¸°ë³¸ ë””ìì¸ ì‚¬ìš©
- `design_name='design_1'`: YAML ê¸°ë°˜ ë””ìì¸ 1 ì‚¬ìš©
- `design_name='design_2'`: YAML ê¸°ë°˜ ë””ìì¸ 2 ì‚¬ìš©

### ìƒˆë¡œ ì¶”ê°€ëœ ê¸°ëŠ¥
- `design_name='template_sample1'`: í…œí”Œë¦¿ ìƒ˜í”Œ 1 ì‚¬ìš©
- `design_name='template_sample2'`: í…œí”Œë¦¿ ìƒ˜í”Œ 2 ì‚¬ìš©

---

## ğŸ“Š ë‹¤ìŒ ë‹¨ê³„ (ì„ íƒì‚¬í•­)

### 1. ì…€ ë§¤í•‘ ì •í™•ì„± ê²€ì¦
- [ ] ì‹¤ì œ í…œí”Œë¦¿ íŒŒì¼ì„ ì—´ì–´ ì…€ êµ¬ì¡° í™•ì¸
- [ ] ì…€ ë§¤í•‘ JSON íŒŒì¼ ìˆ˜ì •
- [ ] ìƒ˜í”Œ ë°ì´í„°ë¡œ ìƒì„± í…ŒìŠ¤íŠ¸

### 2. PDF ìƒì„± ì§€ì›
- [ ] í…œí”Œë¦¿ ê¸°ë°˜ PDF ìƒì„± êµ¬í˜„
- [ ] í…œí”Œë¦¿ ìŠ¤íƒ€ì¼ì„ ë°˜ì˜í•œ PDF ìƒì„±

### 3. ì¶”ê°€ í…œí”Œë¦¿ ì§€ì›
- [ ] ìƒˆë¡œìš´ í…œí”Œë¦¿ íŒŒì¼ ì¶”ê°€
- [ ] ìƒˆë¡œìš´ í…œí”Œë¦¿ í´ë˜ìŠ¤ ìƒì„±
- [ ] DesignFactoryì— ë“±ë¡

---

## ğŸ“ ì°¸ê³ ì‚¬í•­

### í…œí”Œë¦¿ ë¶„ì„ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©ë²•
```bash
# í…œí”Œë¦¿ ë¶„ì„ ë° ì…€ ë§¤í•‘ ìƒì„±
python scripts/analyze_template_cells.py sample/ê¸‰ì—¬ëª…ì„¸ì„œ_template.xlsx \
    payroll_generator/templates/designs/configs/template_sample1_mapping.json
```

### í…ŒìŠ¤íŠ¸ ì‹¤í–‰
```bash
# ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python tests/test_template_design.py

# ë˜ëŠ” pytest ì‚¬ìš© (ì„¤ì¹˜ í•„ìš”)
pytest tests/test_template_design.py -v
```

---

**ì‘ì„±ì**: AI Assistant  
**ì‘ì„±ì¼**: 2025-12-12  
**ìƒíƒœ**: âœ… êµ¬í˜„ ì™„ë£Œ
