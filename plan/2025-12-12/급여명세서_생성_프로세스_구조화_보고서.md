# ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„± í”„ë¡œì„¸ìŠ¤ êµ¬ì¡°í™” ë³´ê³ ì„œ

**ì‘ì„±ì¼**: 2025-12-12  
**ëª©ì **: ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„± ë° ì¶œë ¥ í”„ë¡œì„¸ìŠ¤ì˜ ì „ì²´ íë¦„ê³¼ ê° íŒŒì¼ì˜ ì—­í•  ì •ë¦¬

---

## ğŸ“‹ ëª©ì°¨

1. [ì „ì²´ í”„ë¡œì„¸ìŠ¤ ê°œìš”](#ì „ì²´-í”„ë¡œì„¸ìŠ¤-ê°œìš”)
2. [ì…ë ¥ ë‹¨ê³„ (Input Layer)](#ì…ë ¥-ë‹¨ê³„-input-layer)
3. [ê³„ì‚° ë‹¨ê³„ (Calculation Layer)](#ê³„ì‚°-ë‹¨ê³„-calculation-layer)
4. [ë””ìì¸ ì„ íƒ ë‹¨ê³„ (Design Selection Layer)](#ë””ìì¸-ì„ íƒ-ë‹¨ê³„-design-selection-layer)
5. [ì¶œë ¥ ë‹¨ê³„ (Output Layer)](#ì¶œë ¥-ë‹¨ê³„-output-layer)
6. [ë‹¤ìš´ë¡œë“œ ë‹¨ê³„ (Download Layer)](#ë‹¤ìš´ë¡œë“œ-ë‹¨ê³„-download-layer)
7. [íŒŒì¼ë³„ ì—­í•  ìƒì„¸](#íŒŒì¼ë³„-ì—­í• -ìƒì„¸)
8. [ë°ì´í„° íë¦„ë„](#ë°ì´í„°-íë¦„ë„)

---

## ì „ì²´ í”„ë¡œì„¸ìŠ¤ ê°œìš”

ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„± í”„ë¡œì„¸ìŠ¤ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë‹¨ê³„ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:

```
[ì‚¬ìš©ì ì…ë ¥] 
    â†“
[ê¸‰ì—¬ ê³„ì‚°] 
    â†“
[ë””ìì¸ ì„ íƒ] 
    â†“
[íŒŒì¼ ìƒì„± (Excel/PDF)] 
    â†“
[ë‹¤ìš´ë¡œë“œ/ì €ì¥]
```

### ì§€ì›í•˜ëŠ” ì…ë ¥ ë°©ë²•

1. **ì›¹ í¼ ì§ì ‘ ì…ë ¥** (ë‹¨ì¼/ë‹¤ì¤‘ ì§ì›)
2. **ì›¹ ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ**
3. **ë°ìŠ¤í¬í†± GUI ì—‘ì…€ íŒŒì¼ ì„ íƒ**

### ì§€ì›í•˜ëŠ” ì¶œë ¥ í˜•ì‹

- Excel (`.xlsx`)
- PDF (`.pdf`)
- ë‘˜ ë‹¤ (Excel + PDF)

### ì§€ì›í•˜ëŠ” ë””ìì¸

- `default`: ê¸°ë³¸ ë””ìì¸ (ê¸°ì¡´ ë°©ì‹)
- `design_1`: YAML ê¸°ë°˜ ë””ìì¸ 1
- `design_2`: YAML ê¸°ë°˜ ë””ìì¸ 2
- `template_sample1`: í…œí”Œë¦¿ 1 (ê¸‰ì—¬ëª…ì„¸ì„œ)
- `template_sample2`: í…œí”Œë¦¿ 2 (ì„ê¸ˆëª…ì„¸ì„œ)

---

## ì…ë ¥ ë‹¨ê³„ (Input Layer)

### 1. ì›¹ í¼ ì§ì ‘ ì…ë ¥

#### 1.1 ë‹¨ì¼ ì§ì› ì…ë ¥

**íŒŒì¼**: `app/routes/payroll.py` â†’ `input_form()`

**í”„ë¡œì„¸ìŠ¤**:
1. ì‚¬ìš©ìê°€ ì›¹ í¼ì— ì§ì› ì •ë³´ ì…ë ¥
2. Flask-WTF í¼ ê²€ì¦ (`EmployeeInputForm`)
3. í¼ ë°ì´í„°ë¥¼ ë”•ì…”ë„ˆë¦¬ë¡œ ë³€í™˜
4. ê¸‰ì—¬ ê³„ì‚° ìˆ˜í–‰
5. ê²°ê³¼ë¥¼ ì„¸ì…˜ì— ì €ì¥
6. ê²°ê³¼ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

**ê´€ë ¨ íŒŒì¼**:
- `app/forms/payroll_forms.py`: í¼ ì •ì˜ (`EmployeeInputForm`)
- `web/templates/payroll/input_form.html`: HTML í…œí”Œë¦¿

**ë°ì´í„° êµ¬ì¡°**:
```python
employee_data = {
    'ì´ë¦„': str,
    'ì£¼ë¯¼ë²ˆí˜¸': str (6ìë¦¬),
    'ì…ì‚¬ì¼': str (YYYY-MM-DD),
    'ê¸°ë³¸ê¸‰': int,
    'ë¶€ì–‘ê°€ì¡±ìˆ˜': int,
    'ì€í–‰ëª…': str (ì„ íƒ),
    'ê³„ì¢Œë²ˆí˜¸': str (ì„ íƒ),
    'ì—°ì¥ê·¼ë¬´ì‹œê°„': int (ì„ íƒ),
    'ì—°ì¥ê·¼ë¬´ë‹¨ê°€': int (ì„ íƒ),
    'ìƒì—¬ê¸ˆ': int (ì„ íƒ),
    'ê³µì œì‚¬í•­': str (ì„ íƒ)
}
```

#### 1.2 ë‹¤ì¤‘ ì§ì› ì…ë ¥

**íŒŒì¼**: `app/routes/payroll.py` â†’ `multiple_input_form()`

**í”„ë¡œì„¸ìŠ¤**:
1. ì—¬ëŸ¬ ì§ì› ì •ë³´ë¥¼ í•œ ë²ˆì— ì…ë ¥
2. ê° ì§ì›ë³„ë¡œ ê¸‰ì—¬ ê³„ì‚° ìˆ˜í–‰
3. ê²°ê³¼ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ì„¸ì…˜ì— ì €ì¥
4. ê²°ê³¼ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

**ê´€ë ¨ íŒŒì¼**:
- `web/templates/payroll/multiple_input.html`: HTML í…œí”Œë¦¿
- `web/static/js/multiple_payroll_input.js`: JavaScript (ë™ì  í¼ ê´€ë¦¬)

### 2. ì›¹ ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ

**íŒŒì¼**: `app/routes/main.py` â†’ `upload_file()`

**í”„ë¡œì„¸ìŠ¤**:
1. ì‚¬ìš©ìê°€ ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ
2. íŒŒì¼ ê²€ì¦ (í™•ì¥ì, í¬ê¸°)
3. íŒŒì¼ì„ ì„œë²„ì— ì €ì¥ (`web/uploads/`)
4. `ExcelHandler.read_employee_data()`ë¡œ ì—‘ì…€ ì½ê¸°
5. ê° í–‰(ì§ì›)ë³„ë¡œ ê¸‰ì—¬ ê³„ì‚° ìˆ˜í–‰
6. ê²°ê³¼ë¥¼ ì„¸ì…˜ì— ì €ì¥
7. ê²°ê³¼ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

**ê´€ë ¨ íŒŒì¼**:
- `payroll_generator/excel_handler.py`: ì—‘ì…€ íŒŒì¼ ì½ê¸°/ì“°ê¸°
- `web/templates/index.html`: íŒŒì¼ ì—…ë¡œë“œ UI

**ì—‘ì…€ íŒŒì¼ í˜•ì‹**:
- í•„ìˆ˜ ì»¬ëŸ¼: ì´ë¦„, ì£¼ë¯¼ë²ˆí˜¸, ì…ì‚¬ì¼, ê¸°ë³¸ê¸‰, ë¶€ì–‘ê°€ì¡±ìˆ˜
- ìƒ˜í”Œ í…œí”Œë¦¿: `payroll_generator/templates/employee_template.xlsx`

### 3. ë°ìŠ¤í¬í†± GUI ì—‘ì…€ íŒŒì¼ ì„ íƒ

**íŒŒì¼**: `main.py` â†’ `PayrollApp` í´ë˜ìŠ¤

**í”„ë¡œì„¸ìŠ¤**:
1. ì‚¬ìš©ìê°€ Tkinter GUIì—ì„œ ì—‘ì…€ íŒŒì¼ ì„ íƒ
2. ì¶œë ¥ í´ë” ì„ íƒ
3. ì¶œë ¥ í˜•ì‹ ì„ íƒ (Excel/PDF/ë‘˜ ë‹¤)
4. ë””ìì¸ ì„ íƒ (ì„ íƒì‚¬í•­)
5. `generate_payroll()` ë©”ì„œë“œ ì‹¤í–‰ (ë³„ë„ ìŠ¤ë ˆë“œ)
6. ê° ì§ì›ë³„ë¡œ ê¸‰ì—¬ ê³„ì‚° ë° íŒŒì¼ ìƒì„±
7. ì¶œë ¥ í´ë”ì— íŒŒì¼ ì €ì¥

**ê´€ë ¨ íŒŒì¼**:
- `main.py`: Tkinter GUI ì• í”Œë¦¬ì¼€ì´ì…˜
- `payroll_generator/dashboard.py`: ëŒ€ì‹œë³´ë“œ ê¸°ëŠ¥ (ì„ íƒì‚¬í•­)

---

## ê³„ì‚° ë‹¨ê³„ (Calculation Layer)

### ê¸‰ì—¬ ê³„ì‚° ì—”ì§„

**íŒŒì¼**: `payroll_generator/calculator.py` â†’ `PayrollCalculator` í´ë˜ìŠ¤

**ì£¼ìš” ë©”ì„œë“œ**:
- `calculate_deductions(employee_data)`: ì „ì²´ ê³µì œì•¡ ê³„ì‚°
- `calculate_insurance(base_salary, insurance_type)`: 4ëŒ€ë³´í—˜ ê³„ì‚°
- `calculate_income_tax(taxable_income)`: ì†Œë“ì„¸ ê³„ì‚°

**ê³„ì‚° í”„ë¡œì„¸ìŠ¤**:
1. **ì´ ì§€ê¸‰ì•¡ ê³„ì‚°**
   - ê¸°ë³¸ê¸‰ + ì—°ì¥ê·¼ë¬´ìˆ˜ë‹¹ + ìƒì—¬ê¸ˆ

2. **4ëŒ€ë³´í—˜ ê³„ì‚°** (ê¸°ë³¸ê¸‰ ê¸°ì¤€)
   - êµ­ë¯¼ì—°ê¸ˆ
   - ê±´ê°•ë³´í—˜
   - ì¥ê¸°ìš”ì–‘ë³´í—˜ (ê±´ê°•ë³´í—˜ì˜ 12.95%)
   - ê³ ìš©ë³´í—˜

3. **ë¶€ì–‘ê°€ì¡± ê³µì œì•¡ ê³„ì‚°**
   - ë¶€ì–‘ê°€ì¡±ìˆ˜ì— ë”°ë¥¸ ê³µì œì•¡

4. **ì†Œë“ì„¸ ê³„ì‚°**
   - ê³¼ì„¸í‘œì¤€ = ì´ ì§€ê¸‰ì•¡ - 4ëŒ€ë³´í—˜ - ë¶€ì–‘ê°€ì¡±ê³µì œ
   - ê°„ì´ì„¸ì•¡í‘œ ê¸°ë°˜ ê³„ì‚°

5. **ì§€ë°©ì†Œë“ì„¸ ê³„ì‚°**
   - ì†Œë“ì„¸ì˜ 10%

6. **ì‹¤ìˆ˜ë ¹ì•¡ ê³„ì‚°**
   - ì´ ì§€ê¸‰ì•¡ - ì´ ê³µì œì•¡

**ì„¤ì • íŒŒì¼**:
- `payroll_generator/config.py`: ë³´í—˜ë¥ , ìƒí•œì•¡, ì†Œë“ì„¸ìœ¨ ë“±

**ë°˜í™˜ ë°ì´í„° êµ¬ì¡°**:
```python
payroll_data = {
    'ê¸°ë³¸ê¸‰': int,
    'ì—°ì¥ê·¼ë¬´ìˆ˜ë‹¹': int,
    'ìƒì—¬ê¸ˆ': int,
    'ì´ì§€ê¸‰ì•¡': int,
    'êµ­ë¯¼ì—°ê¸ˆ': int,
    'ê±´ê°•ë³´í—˜': int,
    'ì¥ê¸°ìš”ì–‘': int,
    'ê³ ìš©ë³´í—˜': int,
    'ë¶€ì–‘ê°€ì¡±ê³µì œ': int,
    'ì†Œë“ì„¸': int,
    'ì§€ë°©ì†Œë“ì„¸': int,
    'ì´ê³µì œì•¡': int,
    'ì‹¤ìˆ˜ë ¹ì•¡': int
}
```

---

## ë””ìì¸ ì„ íƒ ë‹¨ê³„ (Design Selection Layer)

### ë””ìì¸ íŒ©í† ë¦¬ íŒ¨í„´

**íŒŒì¼**: `payroll_generator/templates/designs/design_factory.py` â†’ `DesignFactory` í´ë˜ìŠ¤

**ì—­í• **:
- ë””ìì¸ í´ë˜ìŠ¤ì˜ ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬
- ë””ìì¸ ì´ë¦„ìœ¼ë¡œ ë””ìì¸ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜
- ì‚¬ìš© ê°€ëŠ¥í•œ ë””ìì¸ ëª©ë¡ ì œê³µ

**ë“±ë¡ëœ ë””ìì¸**:
```python
_designs = {
    'default': None,  # ê¸°ë³¸ ë°©ì‹ (ê¸°ì¡´ ë¡œì§)
    'design_1': Design1,  # YAML ê¸°ë°˜ ë””ìì¸ 1
    'design_2': Design2,  # YAML ê¸°ë°˜ ë””ìì¸ 2
    'template_sample1': TemplateSample1,  # í…œí”Œë¦¿ 1
    'template_sample2': TemplateSample2,  # í…œí”Œë¦¿ 2
}
```

**ì£¼ìš” ë©”ì„œë“œ**:
- `get_design(design_name)`: ë””ìì¸ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜
- `list_available_designs()`: ì‚¬ìš© ê°€ëŠ¥í•œ ë””ìì¸ ëª©ë¡
- `is_design_available(design_name)`: ë””ìì¸ ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸

### ë””ìì¸ í´ë˜ìŠ¤ ê³„ì¸µ êµ¬ì¡°

#### 1. ê¸°ë³¸ í´ë˜ìŠ¤

**íŒŒì¼**: `payroll_generator/templates/designs/base_design.py` â†’ `BaseDesign` (ì¶”ìƒ í´ë˜ìŠ¤)

**ì—­í• **:
- ëª¨ë“  ë””ìì¸ í´ë˜ìŠ¤ì˜ ê¸°ë³¸ í´ë˜ìŠ¤
- ê³µí†µ ë©”ì„œë“œ ë° ì†ì„± ì •ì˜
- YAML ì„¤ì • íŒŒì¼ ë¡œë“œ (ì„ íƒì‚¬í•­)

**ì¶”ìƒ ë©”ì„œë“œ**:
- `generate_excel(payroll_data, employee_data, output_path, period)`: Excel ìƒì„±
- `generate_pdf(payroll_data, employee_data, output_path, period)`: PDF ìƒì„±

#### 2. YAML ê¸°ë°˜ ë””ìì¸

**íŒŒì¼ë“¤**:
- `payroll_generator/templates/designs/design_1.py` â†’ `Design1`
- `payroll_generator/templates/designs/design_2.py` â†’ `Design2`

**íŠ¹ì§•**:
- YAML ì„¤ì • íŒŒì¼ë¡œ ë ˆì´ì•„ì›ƒ ì •ì˜
- `reportlab`ìœ¼ë¡œ PDF ì§ì ‘ ìƒì„±
- `openpyxl`ë¡œ Excel ì§ì ‘ ìƒì„±

**ì„¤ì • íŒŒì¼**:
- `payroll_generator/templates/designs/configs/design_1.yaml`
- `payroll_generator/templates/designs/configs/design_2.yaml`

#### 3. í…œí”Œë¦¿ ê¸°ë°˜ ë””ìì¸

**íŒŒì¼ë“¤**:
- `payroll_generator/templates/designs/template_design.py` â†’ `TemplateDesign` (ê¸°ë³¸ í´ë˜ìŠ¤)
- `payroll_generator/templates/designs/template_sample1.py` â†’ `TemplateSample1`
- `payroll_generator/templates/designs/template_sample2.py` â†’ `TemplateSample2`

**íŠ¹ì§•**:
- ê¸°ì¡´ Excel í…œí”Œë¦¿ íŒŒì¼ì„ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±
- ì…€ ë§¤í•‘ JSON íŒŒì¼ë¡œ ë°ì´í„° ìœ„ì¹˜ ì •ì˜
- Excel ìƒì„±: í…œí”Œë¦¿ ë³µì‚¬ â†’ ë°ì´í„° ì±„ìš°ê¸°
- PDF ìƒì„±: Excel â†’ PDF ë³€í™˜ (xlsx2pdf, LibreOffice, COM ê°ì²´)

**í…œí”Œë¦¿ íŒŒì¼**:
- `payroll_generator/templates/designs/template_sample1.xlsx`
- `payroll_generator/templates/designs/template_sample2.xlsx`

**ë§¤í•‘ íŒŒì¼**:
- `payroll_generator/templates/designs/configs/template_sample1_mapping.json`
- `payroll_generator/templates/designs/configs/template_sample2_mapping.json`

---

## ì¶œë ¥ ë‹¨ê³„ (Output Layer)

### 1. Excel ìƒì„±

#### 1.1 ë””ìì¸ ì„ íƒ ì‹œ

**í”„ë¡œì„¸ìŠ¤**:
1. `ExcelHandler.write_payroll()` í˜¸ì¶œ ì‹œ `design_name` íŒŒë¼ë¯¸í„° ì „ë‹¬
2. `DesignFactory.get_design(design_name)`ìœ¼ë¡œ ë””ìì¸ ì¸ìŠ¤í„´ìŠ¤ ê°€ì ¸ì˜¤ê¸°
3. ë””ìì¸ ì¸ìŠ¤í„´ìŠ¤ì˜ `generate_excel()` ë©”ì„œë“œ í˜¸ì¶œ
4. ë””ìì¸ë³„ êµ¬í˜„ì— ë”°ë¼ Excel íŒŒì¼ ìƒì„±

**íŒŒì¼**: `payroll_generator/excel_handler.py` â†’ `ExcelHandler.write_payroll()`

**ì½”ë“œ íë¦„**:
```python
if design_name:
    design = DesignFactory.get_design(design_name)
    if design:
        return design.generate_excel(payroll_data, employee_data, output_path, period)
# ê¸°ì¡´ ë¡œì§ (í…œí”Œë¦¿ ê¸°ë°˜ ë˜ëŠ” ì½”ë“œ ê¸°ë°˜)
```

#### 1.2 ê¸°ë³¸ ë°©ì‹ (ë””ìì¸ ì„ íƒ ì—†ìŒ)

**í”„ë¡œì„¸ìŠ¤**:
1. í…œí”Œë¦¿ ê¸°ë°˜ ìƒì„± ì‹œë„ (`use_template=True`)
2. ì‹¤íŒ¨ ì‹œ ì½”ë“œ ê¸°ë°˜ ìƒì„±ìœ¼ë¡œ í´ë°±

**í…œí”Œë¦¿ íŒŒì¼**: `payroll_generator/templates/payroll_template.xlsx`

### 2. PDF ìƒì„±

#### 2.1 ë””ìì¸ ì„ íƒ ì‹œ

**í”„ë¡œì„¸ìŠ¤**:
1. `PDFGenerator.generate_payslip()` í˜¸ì¶œ ì‹œ `design_name` íŒŒë¼ë¯¸í„° ì „ë‹¬
2. `DesignFactory.get_design(design_name)`ìœ¼ë¡œ ë””ìì¸ ì¸ìŠ¤í„´ìŠ¤ ê°€ì ¸ì˜¤ê¸°
3. ë””ìì¸ ì¸ìŠ¤í„´ìŠ¤ì˜ `generate_pdf()` ë©”ì„œë“œ í˜¸ì¶œ
4. ë””ìì¸ë³„ êµ¬í˜„ì— ë”°ë¼ PDF íŒŒì¼ ìƒì„±

**íŒŒì¼**: `payroll_generator/pdf_generator.py` â†’ `PDFGenerator.generate_payslip()`

**ì½”ë“œ íë¦„**:
```python
if design_name:
    design = DesignFactory.get_design(design_name)
    if design:
        return design.generate_pdf(payroll_data, employee_data, output_path, period)
# ê¸°ì¡´ ë¡œì§ (í…œí”Œë¦¿ ê¸°ë°˜ ë˜ëŠ” ì½”ë“œ ê¸°ë°˜)
```

#### 2.2 ê¸°ë³¸ ë°©ì‹ (ë””ìì¸ ì„ íƒ ì—†ìŒ)

**í”„ë¡œì„¸ìŠ¤**:
1. í…œí”Œë¦¿ ê¸°ë°˜ ìƒì„± ì‹œë„ (`use_template=True`)
   - Excel í…œí”Œë¦¿ì„ ì‚¬ìš©í•˜ì—¬ Excel ìƒì„±
   - Excel â†’ PDF ë³€í™˜ (LibreOffice, COM ê°ì²´ ë“±)
2. ì‹¤íŒ¨ ì‹œ ì½”ë“œ ê¸°ë°˜ ìƒì„±ìœ¼ë¡œ í´ë°±
   - `reportlab`ìœ¼ë¡œ ì§ì ‘ PDF ìƒì„±

**íŒŒì¼**: `payroll_generator/pdf_generator.py` â†’ `_generate_payslip_code_based()`

---

## ë‹¤ìš´ë¡œë“œ ë‹¨ê³„ (Download Layer)

### 1. ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜

#### 1.1 ê°œë³„ ë‹¤ìš´ë¡œë“œ

**íŒŒì¼**: `app/routes/main.py` â†’ `download_file(format, employee_name)`

**í”„ë¡œì„¸ìŠ¤**:
1. ì„¸ì…˜ì—ì„œ í•´ë‹¹ ì§ì›ì˜ ê²°ê³¼ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
2. íŒŒì¼ ìƒì„± (Excel ë˜ëŠ” PDF)
3. `send_file()`ë¡œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì œê³µ

**ì—”ë“œí¬ì¸íŠ¸**:
- `/download/excel/<employee_name>`: Excel ë‹¤ìš´ë¡œë“œ
- `/download/pdf/<employee_name>`: PDF ë‹¤ìš´ë¡œë“œ

#### 1.2 ì¼ê´„ ë‹¤ìš´ë¡œë“œ

**íŒŒì¼**: `app/routes/main.py` â†’ `batch_download(format)`

**í”„ë¡œì„¸ìŠ¤**:
1. ì„¸ì…˜ì—ì„œ ëª¨ë“  ì§ì›ì˜ ê²°ê³¼ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
2. ê° ì§ì›ë³„ë¡œ íŒŒì¼ ìƒì„±
3. ZIP íŒŒì¼ë¡œ ì••ì¶•
4. ZIP íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì œê³µ

**ì—”ë“œí¬ì¸íŠ¸**:
- `/batch_download/excel`: Excel ì¼ê´„ ë‹¤ìš´ë¡œë“œ
- `/batch_download/pdf`: PDF ì¼ê´„ ë‹¤ìš´ë¡œë“œ
- `/batch_download/both`: Excel + PDF ì¼ê´„ ë‹¤ìš´ë¡œë“œ

**ì¶œë ¥ í´ë”**:
- Excel: `outputs/excel/`
- PDF: `outputs/pdf/`

### 2. ë°ìŠ¤í¬í†± ì• í”Œë¦¬ì¼€ì´ì…˜

**í”„ë¡œì„¸ìŠ¤**:
1. ì‚¬ìš©ìê°€ ì„ íƒí•œ ì¶œë ¥ í´ë”ì— íŒŒì¼ ì €ì¥
2. ìƒì„± ì™„ë£Œ í›„ í´ë” ì—´ê¸° ì˜µì…˜ ì œê³µ

**ì¶œë ¥ ìœ„ì¹˜**: ì‚¬ìš©ìê°€ ì„ íƒí•œ í´ë”

---

## íŒŒì¼ë³„ ì—­í•  ìƒì„¸

### ì…ë ¥ ê´€ë ¨ íŒŒì¼

| íŒŒì¼ ê²½ë¡œ | ì—­í•  | ì£¼ìš” í´ë˜ìŠ¤/í•¨ìˆ˜ |
|---------|------|----------------|
| `app/routes/payroll.py` | ì›¹ í¼ ì…ë ¥ ì²˜ë¦¬ | `input_form()`, `multiple_input_form()` |
| `app/forms/payroll_forms.py` | í¼ ì •ì˜ | `EmployeeInputForm` |
| `app/routes/main.py` | íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬ | `upload_file()` |
| `web/templates/payroll/input_form.html` | ë‹¨ì¼ ì§ì› ì…ë ¥ UI | HTML í…œí”Œë¦¿ |
| `web/templates/payroll/multiple_input.html` | ë‹¤ì¤‘ ì§ì› ì…ë ¥ UI | HTML í…œí”Œë¦¿ |
| `main.py` | ë°ìŠ¤í¬í†± GUI | `PayrollApp` í´ë˜ìŠ¤ |

### ê³„ì‚° ê´€ë ¨ íŒŒì¼

| íŒŒì¼ ê²½ë¡œ | ì—­í•  | ì£¼ìš” í´ë˜ìŠ¤/í•¨ìˆ˜ |
|---------|------|----------------|
| `payroll_generator/calculator.py` | ê¸‰ì—¬ ê³„ì‚° ì—”ì§„ | `PayrollCalculator` |
| `payroll_generator/config.py` | ê³„ì‚° ì„¤ì • (ë³´í—˜ë¥ , ì„¸ìœ¨ ë“±) | ìƒìˆ˜ ì •ì˜ |

### ë””ìì¸ ê´€ë ¨ íŒŒì¼

| íŒŒì¼ ê²½ë¡œ | ì—­í•  | ì£¼ìš” í´ë˜ìŠ¤/í•¨ìˆ˜ |
|---------|------|----------------|
| `payroll_generator/templates/designs/design_factory.py` | ë””ìì¸ íŒ©í† ë¦¬ | `DesignFactory` |
| `payroll_generator/templates/designs/base_design.py` | ë””ìì¸ ê¸°ë³¸ í´ë˜ìŠ¤ | `BaseDesign` (ì¶”ìƒ) |
| `payroll_generator/templates/designs/design_1.py` | ë””ìì¸ 1 êµ¬í˜„ | `Design1` |
| `payroll_generator/templates/designs/design_2.py` | ë””ìì¸ 2 êµ¬í˜„ | `Design2` |
| `payroll_generator/templates/designs/template_design.py` | í…œí”Œë¦¿ ë””ìì¸ ê¸°ë³¸ í´ë˜ìŠ¤ | `TemplateDesign` |
| `payroll_generator/templates/designs/template_sample1.py` | í…œí”Œë¦¿ 1 êµ¬í˜„ | `TemplateSample1` |
| `payroll_generator/templates/designs/template_sample2.py` | í…œí”Œë¦¿ 2 êµ¬í˜„ | `TemplateSample2` |
| `payroll_generator/templates/designs/configs/*.yaml` | YAML ë””ìì¸ ì„¤ì • íŒŒì¼ | - |
| `payroll_generator/templates/designs/configs/*.json` | í…œí”Œë¦¿ ì…€ ë§¤í•‘ íŒŒì¼ | - |

### ì¶œë ¥ ê´€ë ¨ íŒŒì¼

| íŒŒì¼ ê²½ë¡œ | ì—­í•  | ì£¼ìš” í´ë˜ìŠ¤/í•¨ìˆ˜ |
|---------|------|----------------|
| `payroll_generator/excel_handler.py` | Excel ìƒì„± í•¸ë“¤ëŸ¬ | `ExcelHandler` |
| `payroll_generator/pdf_generator.py` | PDF ìƒì„± í•¸ë“¤ëŸ¬ | `PDFGenerator` |

### ë‹¤ìš´ë¡œë“œ ê´€ë ¨ íŒŒì¼

| íŒŒì¼ ê²½ë¡œ | ì—­í•  | ì£¼ìš” í´ë˜ìŠ¤/í•¨ìˆ˜ |
|---------|------|----------------|
| `app/routes/main.py` | ì›¹ ë‹¤ìš´ë¡œë“œ ì²˜ë¦¬ | `download_file()`, `batch_download()` |
| `main.py` | ë°ìŠ¤í¬í†± íŒŒì¼ ì €ì¥ | `PayrollApp.generate_payroll()` |

### ìœ í‹¸ë¦¬í‹° íŒŒì¼

| íŒŒì¼ ê²½ë¡œ | ì—­í•  | ì£¼ìš” í´ë˜ìŠ¤/í•¨ìˆ˜ |
|---------|------|----------------|
| `payroll_generator/logger.py` | ë¡œê¹… ì„¤ì • | `setup_logger()` |
| `payroll_generator/utils.py` | ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ | `resource_path()` ë“± |
| `app/utils/analytics.py` | ì‚¬ìš©ì í™œë™ ë¡œê¹… | `log_activity()`, `log_payroll_calculation()` |

---

## ë°ì´í„° íë¦„ë„

### ì›¹ í¼ ì…ë ¥ â†’ íŒŒì¼ ìƒì„±

```
[ì‚¬ìš©ì ì…ë ¥]
    â†“
[Flask Form ê²€ì¦] (payroll_forms.py)
    â†“
[ë°ì´í„° ë³€í™˜] (payroll.py)
    â†“
[ê¸‰ì—¬ ê³„ì‚°] (calculator.py)
    â†“
[ê²°ê³¼ ì„¸ì…˜ ì €ì¥] (payroll.py)
    â†“
[ê²°ê³¼ í˜ì´ì§€ í‘œì‹œ] (main.py â†’ result.html)
    â†“
[íŒŒì¼ ë‹¤ìš´ë¡œë“œ ìš”ì²­] (main.py â†’ download_file())
    â†“
[ë””ìì¸ ì„ íƒ] (design_factory.py)
    â†“
[Excel/PDF ìƒì„±] (excel_handler.py / pdf_generator.py)
    â†“
[íŒŒì¼ ë‹¤ìš´ë¡œë“œ] (send_file())
```

### ì—‘ì…€ ì—…ë¡œë“œ â†’ íŒŒì¼ ìƒì„±

```
[ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ]
    â†“
[íŒŒì¼ ê²€ì¦ ë° ì €ì¥] (main.py â†’ upload_file())
    â†“
[ì—‘ì…€ ì½ê¸°] (excel_handler.py â†’ read_employee_data())
    â†“
[ê° í–‰ë³„ ì²˜ë¦¬]
    â”œâ”€â†’ [ê¸‰ì—¬ ê³„ì‚°] (calculator.py)
    â””â”€â†’ [ê²°ê³¼ ì €ì¥] (ì„¸ì…˜)
    â†“
[ê²°ê³¼ í˜ì´ì§€ í‘œì‹œ] (main.py â†’ result.html)
    â†“
[íŒŒì¼ ë‹¤ìš´ë¡œë“œ ìš”ì²­] (main.py â†’ download_file())
    â†“
[ë””ìì¸ ì„ íƒ] (design_factory.py)
    â†“
[Excel/PDF ìƒì„±] (excel_handler.py / pdf_generator.py)
    â†“
[íŒŒì¼ ë‹¤ìš´ë¡œë“œ] (send_file())
```

### ë°ìŠ¤í¬í†± GUI â†’ íŒŒì¼ ìƒì„±

```
[GUIì—ì„œ íŒŒì¼ ì„ íƒ]
    â†“
[ì—‘ì…€ ì½ê¸°] (excel_handler.py â†’ read_employee_data())
    â†“
[ê° í–‰ë³„ ì²˜ë¦¬]
    â”œâ”€â†’ [ê¸‰ì—¬ ê³„ì‚°] (calculator.py)
    â””â”€â†’ [íŒŒì¼ ìƒì„±] (excel_handler.py / pdf_generator.py)
        â”œâ”€â†’ [ë””ìì¸ ì„ íƒ] (design_factory.py)
        â””â”€â†’ [Excel/PDF ìƒì„±]
    â†“
[ì¶œë ¥ í´ë”ì— ì €ì¥]
```

---

## ì£¼ìš” ì˜ì¡´ì„±

### Python íŒ¨í‚¤ì§€

- **Flask**: ì›¹ í”„ë ˆì„ì›Œí¬
- **Flask-WTF**: í¼ ì²˜ë¦¬
- **pandas**: ë°ì´í„° ì²˜ë¦¬
- **openpyxl**: Excel íŒŒì¼ ì²˜ë¦¬
- **reportlab**: PDF ìƒì„±
- **PyYAML**: YAML ì„¤ì • íŒŒì¼ ì²˜ë¦¬ (ì„ íƒì‚¬í•­)
- **xlsx2pdf**: Excel â†’ PDF ë³€í™˜ (ì„ íƒì‚¬í•­)

### ì™¸ë¶€ í”„ë¡œê·¸ë¨ (ì„ íƒì‚¬í•­)

- **LibreOffice**: Excel â†’ PDF ë³€í™˜ (í…œí”Œë¦¿ ë””ìì¸ìš©)
- **Microsoft Excel (Windows)**: COM ê°ì²´ë¥¼ í†µí•œ Excel â†’ PDF ë³€í™˜

---

## ì„¸ì…˜ ë°ì´í„° êµ¬ì¡°

### ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¸ì…˜

```python
session = {
    'session_id': str,  # UUID
    'results': [
        {
            'employee_name': str,
            'payroll_data': dict,  # calculator.calculate_deductions() ê²°ê³¼
            'employee_data': dict   # ì…ë ¥ëœ ì§ì› ì •ë³´
        },
        ...
    ],
    'period': str,  # YYYY-MM í˜•ì‹
    'output_format': str,  # 'excel', 'pdf', 'both'
    'design_name': str or None,  # ë””ìì¸ ì´ë¦„ ë˜ëŠ” None
    'input_method': str,  # 'web_form', 'web_form_multiple', 'file_upload'
    'filepath': str  # ì—…ë¡œë“œëœ íŒŒì¼ ê²½ë¡œ (íŒŒì¼ ì—…ë¡œë“œ ì‹œ)
}
```

---

## ì—ëŸ¬ ì²˜ë¦¬ ë° ë¡œê¹…

### ë¡œê¹…

- **íŒŒì¼**: `payroll_generator/logger.py`
- **ë¡œê¹… ë ˆë²¨**: DEBUG, INFO, WARNING, ERROR
- **ë¡œê·¸ íŒŒì¼**: `logs/payroll_generator.log`

### ì—ëŸ¬ ì²˜ë¦¬ ì „ëµ

1. **ê³„ì‚° ì˜¤ë¥˜**: í•´ë‹¹ ì§ì›ë§Œ ê±´ë„ˆë›°ê³  ë‹¤ìŒ ì§ì› ì²˜ë¦¬ ê³„ì†
2. **íŒŒì¼ ìƒì„± ì˜¤ë¥˜**: 
   - Excel ìƒì„± ì‹¤íŒ¨: ì—ëŸ¬ ë¡œê·¸ë§Œ ê¸°ë¡
   - PDF ìƒì„± ì‹¤íŒ¨: ê²½ê³  ë¡œê·¸ ê¸°ë¡ (Excelì€ ìƒì„±ë¨)
3. **ë””ìì¸ ë¡œë“œ ì‹¤íŒ¨**: ê¸°ë³¸ ë°©ì‹ìœ¼ë¡œ í´ë°±
4. **í…œí”Œë¦¿ ê¸°ë°˜ ìƒì„± ì‹¤íŒ¨**: ì½”ë“œ ê¸°ë°˜ ìƒì„±ìœ¼ë¡œ í´ë°±

---

## í™•ì¥ì„± ê³ ë ¤ì‚¬í•­

### ìƒˆë¡œìš´ ë””ìì¸ ì¶”ê°€

1. `BaseDesign`ì„ ìƒì†ë°›ëŠ” ìƒˆ ë””ìì¸ í´ë˜ìŠ¤ ìƒì„±
2. `design_factory.py`ì— ë””ìì¸ ë“±ë¡
3. ì›¹/ë°ìŠ¤í¬í†± UIì— ë””ìì¸ ì˜µì…˜ ì¶”ê°€

### ìƒˆë¡œìš´ ì…ë ¥ ë°©ë²• ì¶”ê°€

1. ìƒˆë¡œìš´ ë¼ìš°íŠ¸/í•¨ìˆ˜ ì¶”ê°€
2. ë°ì´í„°ë¥¼ í‘œì¤€ í˜•ì‹(`employee_data` ë”•ì…”ë„ˆë¦¬)ìœ¼ë¡œ ë³€í™˜
3. ê¸°ì¡´ ê³„ì‚° ë° ì¶œë ¥ ë¡œì§ ì¬ì‚¬ìš©

### ìƒˆë¡œìš´ ì¶œë ¥ í˜•ì‹ ì¶”ê°€

1. `BaseDesign`ì— ìƒˆ ë©”ì„œë“œ ì¶”ê°€ (ì˜ˆ: `generate_html()`)
2. ë””ìì¸ í´ë˜ìŠ¤ì—ì„œ êµ¬í˜„
3. ë‹¤ìš´ë¡œë“œ ë¼ìš°íŠ¸ì— ìƒˆ ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€

---

## ê²°ë¡ 

ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„± í”„ë¡œì„¸ìŠ¤ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê³„ì¸µ êµ¬ì¡°ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤:

1. **ì…ë ¥ ê³„ì¸µ**: ë‹¤ì–‘í•œ ì…ë ¥ ë°©ë²• ì§€ì› (ì›¹ í¼, íŒŒì¼ ì—…ë¡œë“œ, ë°ìŠ¤í¬í†± GUI)
2. **ê³„ì‚° ê³„ì¸µ**: í‘œì¤€í™”ëœ ê¸‰ì—¬ ê³„ì‚° ì—”ì§„
3. **ë””ìì¸ ê³„ì¸µ**: íŒ©í† ë¦¬ íŒ¨í„´ì„ í†µí•œ ìœ ì—°í•œ ë””ìì¸ ì‹œìŠ¤í…œ
4. **ì¶œë ¥ ê³„ì¸µ**: Excel/PDF ìƒì„± ë° ë³€í™˜
5. **ë‹¤ìš´ë¡œë“œ ê³„ì¸µ**: ì›¹/ë°ìŠ¤í¬í†± í™˜ê²½ë³„ ë‹¤ìš´ë¡œë“œ ì²˜ë¦¬

ê° ê³„ì¸µì€ ë…ë¦½ì ìœ¼ë¡œ ë™ì‘í•˜ë©°, ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ì—°ê²°ë©ë‹ˆë‹¤. ì´ êµ¬ì¡°ëŠ” í™•ì¥ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì„ ê³ ë ¤í•˜ì—¬ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.
