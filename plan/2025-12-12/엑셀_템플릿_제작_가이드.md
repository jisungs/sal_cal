# 📋 엑셀 템플릿 제작 가이드

**작성일**: 2025-12-12  
**목적**: 디자인 선택 기능을 위한 엑셀 템플릿 제작 가이드  
**대상**: 디자인 1, 디자인 2 템플릿 제작자

---

## 📋 개요

이 가이드는 급여명세서 디자인 선택 기능을 위해 필요한 엑셀 템플릿을 제작하는 방법을 설명합니다.

### 필요한 템플릿
- `design_1_template.xlsx`: 디자인 1 템플릿 (급여명세서_sample.png 기반)
- `design_2_template.xlsx`: 디자인 2 템플릿 (급여명세서_sample2.png 기반)

### 저장 위치
- `payroll_generator/templates/designs/design_1_template.xlsx`
- `payroll_generator/templates/designs/design_2_template.xlsx`

---

## 📐 템플릿 구조 요구사항

### 1. 필수 포함 항목

#### 1.1 제목 영역
- **제목**: "급여명세서" (A1 또는 원하는 위치)
- **지급기간**: "지급기간: 2025-01" 형식 (A2 또는 원하는 위치)
  - 실제 값은 코드에서 채워넣음
  - 예: `지급기간: {PERIOD}` 또는 빈 셀 (코드에서 채움)

#### 1.2 직원 정보 영역
다음 정보를 포함해야 합니다:

| 항목 | 설명 | 예시 셀 위치 | 데이터 소스 |
|------|------|------------|------------|
| 성명 | 직원 이름 | B4 | `employee_data['이름']` |
| 주민번호 | 주민번호 (마스킹 처리됨) | B5 | `employee_data['주민번호']` (자동 마스킹) |
| 입사일 | 입사일 (YYYY-MM-DD) | B6 | `employee_data['입사일']` |

**참고**: 셀 위치는 샘플 이미지의 레이아웃에 맞게 조정 가능합니다.

#### 1.3 지급 항목 영역
다음 항목을 포함해야 합니다:

| 항목 | 설명 | 예시 셀 위치 | 데이터 소스 |
|------|------|------------|------------|
| 기본급 | 월 기본급 | C8 또는 원하는 위치 | `payroll_data['기본급']` |
| 연장근무수당 | 연장근무 수당 | C9 | `payroll_data['연장근무수당']` |
| 상여금 | 상여금 | C10 | `payroll_data['상여금']` |
| 총 지급액 | 지급 항목 합계 | C11 | `payroll_data['총지급액']` |

**참고**: 
- 항목명은 별도 셀에 표시 (예: B8에 "기본급", C8에 금액)
- 0원인 항목도 표시 가능 (코드에서 처리)

#### 1.4 공제 항목 영역
다음 항목을 포함해야 합니다:

| 항목 | 설명 | 예시 셀 위치 | 데이터 소스 |
|------|------|------------|------------|
| 국민연금 | 국민연금 공제액 | C15 | `payroll_data['국민연금']` |
| 건강보험 | 건강보험 공제액 | C16 | `payroll_data['건강보험']` |
| 장기요양 | 장기요양 공제액 | C17 | `payroll_data['장기요양']` |
| 고용보험 | 고용보험 공제액 | C18 | `payroll_data['고용보험']` |
| 소득세 | 소득세 공제액 | C19 | `payroll_data['소득세']` |
| 지방소득세 | 지방소득세 공제액 | C20 | `payroll_data['지방소득세']` |
| 총 공제액 | 공제 항목 합계 | C21 | `payroll_data['총공제액']` |

#### 1.5 실수령액 영역
- **실수령액**: 최종 실수령액 (A23 또는 원하는 위치)
  - 예: `실수령액: 2,500,000원` 형식
  - 데이터 소스: `payroll_data['실수령액']`

---

## 🎨 스타일 적용 가이드

### 샘플 이미지 분석 결과 반영

템플릿 제작 시 샘플 이미지(`급여명세서_sample.png`, `급여명세서_sample2.png`)를 참고하여 다음을 적용하세요:

#### 1. 색상
- **제목 배경색**: 샘플 이미지의 제목 영역 배경색
- **헤더 배경색**: 지급/공제 항목 헤더 배경색
- **총액 배경색**: 총 지급액/총 공제액/실수령액 배경색
- **테두리 색상**: 셀 테두리 색상

#### 2. 폰트
- **제목 폰트**: 크기, 굵기, 색상
- **본문 폰트**: 크기, 색상
- **숫자 폰트**: 금액 표시 폰트

#### 3. 레이아웃
- **셀 병합**: 제목, 헤더 등 병합된 셀
- **정렬**: 텍스트 정렬 (좌, 중앙, 우)
- **행 높이**: 각 행의 높이
- **열 너비**: 각 열의 너비
- **여백**: 셀 내부 여백

#### 4. 테두리
- **외곽 테두리**: 전체 영역 테두리
- **내부 테두리**: 셀 간 테두리
- **테두리 스타일**: 실선, 점선 등

---

## 📝 템플릿 제작 단계

### Step 1: 샘플 이미지 분석
1. 샘플 이미지를 엑셀에서 열어서 레이아웃 파악
2. 각 영역의 위치, 크기, 색상 확인
3. 폰트 크기 및 스타일 확인

### Step 2: 기본 레이아웃 구성
1. 제목 영역 배치
2. 직원 정보 영역 배치
3. 지급 항목 영역 배치
4. 공제 항목 영역 배치
5. 실수령액 영역 배치

### Step 3: 스타일 적용
1. 색상 적용 (배경색, 텍스트 색상)
2. 폰트 설정 (크기, 굵기, 스타일)
3. 테두리 설정
4. 정렬 설정

### Step 4: 데이터 셀 위치 확인
1. 각 데이터가 들어갈 셀 위치 확인
2. 셀 위치를 문서화 (나중에 코드에서 사용)

### Step 5: 테스트
1. 샘플 데이터로 수동 입력하여 레이아웃 확인
2. 샘플 이미지와 비교하여 차이점 확인
3. 필요시 수정

---

## 📋 셀 위치 매핑 예시

템플릿 제작 후, 각 데이터가 들어갈 셀 위치를 다음과 같이 문서화해주세요:

### 디자인 1 템플릿 예시

```python
# design_1_cell_mapping.py (참고용)
DESIGN_1_CELL_MAPPING = {
    # 제목 및 기간
    'title': 'A1',  # "급여명세서"
    'period': 'A2',  # "지급기간: 2025-01"
    
    # 직원 정보
    'employee_name': 'B4',  # 직원 이름
    'resident_number': 'B5',  # 주민번호 (마스킹 처리됨)
    'join_date': 'B6',  # 입사일
    
    # 지급 항목
    'basic_salary': 'C8',  # 기본급
    'overtime': 'C9',  # 연장근무수당
    'bonus': 'C10',  # 상여금
    'total_payment': 'C11',  # 총 지급액
    
    # 공제 항목
    'national_pension': 'C15',  # 국민연금
    'health_insurance': 'C16',  # 건강보험
    'long_term_care': 'C17',  # 장기요양
    'employment_insurance': 'C18',  # 고용보험
    'income_tax': 'C19',  # 소득세
    'local_income_tax': 'C20',  # 지방소득세
    'total_deduction': 'C21',  # 총 공제액
    
    # 실수령액
    'net_pay': 'A23',  # 실수령액
}
```

**참고**: 실제 셀 위치는 샘플 이미지의 레이아웃에 맞게 조정하세요.

---

## 🔧 템플릿 제작 팁

### 1. 셀 위치 지정 방식 (권장)

**방법 A: 고정 셀 위치 사용**
- 각 데이터가 들어갈 셀 위치를 고정
- 예: 이름은 항상 B4, 기본급은 항상 C8
- 코드에서 셀 위치를 직접 지정하여 데이터 채움

**방법 B: 플레이스홀더 사용**
- 셀에 `{이름}`, `{기본급}` 등의 플레이스홀더 입력
- 코드에서 플레이스홀더를 찾아 교체
- 더 유연하지만 구현 복잡도 높음

**권장**: 방법 A (고정 셀 위치) - 더 정확하고 구현이 간단함

### 2. 숫자 포맷 설정

금액 셀에 숫자 포맷을 설정하세요:
- **형식**: `#,##0` 또는 `#,##0원`
- 엑셀에서 셀 서식 → 숫자 → 사용자 지정

### 3. 샘플 데이터로 테스트

템플릿 제작 후 샘플 데이터를 수동으로 입력하여 확인:
- 레이아웃이 깨지지 않는지
- 색상, 폰트가 올바른지
- 숫자 포맷이 올바른지

---

## 📄 템플릿 파일 요구사항 요약

### 필수 사항
- ✅ 샘플 이미지와 동일한 레이아웃
- ✅ 모든 필수 필드 포함 (직원 정보, 지급 항목, 공제 항목, 실수령액)
- ✅ 샘플 이미지와 동일한 스타일 (색상, 폰트, 테두리)
- ✅ 셀 위치 문서화 (나중에 코드에서 사용)

### 선택 사항
- ⚪ 플레이스홀더 사용 (고정 셀 위치 방식이 더 권장)
- ⚪ 추가 디자인 요소 (로고, 회사 정보 등)

---

## 📞 템플릿 제작 완료 후

템플릿 제작이 완료되면:
1. 파일을 지정된 위치에 저장
   - `payroll_generator/templates/designs/design_1_template.xlsx`
   - `payroll_generator/templates/designs/design_2_template.xlsx`

2. 셀 위치 매핑 문서 제공
   - 각 데이터가 들어갈 셀 위치 목록
   - 예시 형식은 위 "셀 위치 매핑 예시" 참조

3. 템플릿 테스트
   - 샘플 데이터로 수동 입력하여 레이아웃 확인

---

## 🎯 다음 단계

템플릿 제작이 완료되면:
1. 셀 위치 매핑 문서를 코드 개발자에게 제공
2. 코드 개발자가 템플릿을 사용하여 데이터 채우기 구현
3. 테스트 및 검증

---

**작성자**: AI Assistant  
**작성일**: 2025-12-12  
**상태**: ✅ 템플릿 제작 가이드 작성 완료
