# í…œí”Œë¦¿ ë””ìì¸ ë¯¸ì ìš© ê·¼ë³¸ ì›ì¸ ìµœì¢… ë³´ê³ ì„œ

**ì‘ì„±ì¼**: 2025-12-12  
**ë¬¸ì œ**: í…œí”Œë¦¿1 ì„ íƒ ì‹œ ê¸°ë³¸ ë””ìì¸ìœ¼ë¡œ PDF ìƒì„±ë¨  
**ê·¼ë³¸ ì›ì¸**: Import ì²´ì¸ ì‹¤íŒ¨ (yaml â†’ openpyxl)

---

## ğŸ” ê·¼ë³¸ ì›ì¸ ë°œê²¬

### ì‹¤ì œ í…ŒìŠ¤íŠ¸ ê²°ê³¼

```
âŒ BaseDesign Import ì‹¤íŒ¨: No module named 'yaml'
âŒ TemplateDesign Import ì‹¤íŒ¨: No module named 'openpyxl'
âŒ TemplateSample1 Import ì‹¤íŒ¨: No module named 'openpyxl'
âŒ DesignFactory._designs['template_sample1'] = None
```

### ë¬¸ì œì˜ ì—°ì‡„ ë°˜ì‘

```
1. base_design.py: import yaml ì‹¤íŒ¨
   â†“
2. __init__.py: from .base_design import BaseDesign ì‹¤íŒ¨
   â†“
3. template_design.py: import openpyxl ì‹¤íŒ¨
   â†“
4. template_sample1.py: from .template_design import TemplateDesign ì‹¤íŒ¨
   â†“
5. design_factory.py: from .template_sample1 import TemplateSample1 ì‹¤íŒ¨
   â†“
6. DesignFactory._designs['template_sample1'] = None
   â†“
7. DesignFactory.get_design('template_sample1') â†’ None ë°˜í™˜
   â†“
8. pdf_generator.py: if design: ì¡°ê±´ì´ False
   â†“
9. ê¸°ë³¸ PDF ìƒì„± ë¡œì§ ì‹¤í–‰
```

---

## ğŸ¯ ê·¼ë³¸ ì›ì¸

### ì›ì¸ 1: yaml ëª¨ë“ˆ ì—†ìŒ (1ì°¨ ë¬¸ì œ)

**ìœ„ì¹˜**: `base_design.py:3`
```python
import yaml  # âŒ ModuleNotFoundError
```

**ì˜í–¥**:
- `BaseDesign` í´ë˜ìŠ¤ Import ì‹¤íŒ¨
- `__init__.py`ì—ì„œ `BaseDesign` Import ì‹¤íŒ¨
- ì „ì²´ íŒ¨í‚¤ì§€ Import ì‹¤íŒ¨

**í•´ê²°**: `BaseDesign`ì—ì„œ yaml Importë¥¼ ì„ íƒì ìœ¼ë¡œ ë§Œë“¤ê¸° (ì™„ë£Œ)

### ì›ì¸ 2: openpyxl ëª¨ë“ˆ ì—†ìŒ (2ì°¨ ë¬¸ì œ)

**ìœ„ì¹˜**: `template_design.py:2`
```python
import openpyxl  # âŒ ModuleNotFoundError
```

**ì˜í–¥**:
- `TemplateDesign` í´ë˜ìŠ¤ Import ì‹¤íŒ¨
- `TemplateSample1`ì´ `TemplateDesign`ì„ ìƒì†ë°›ìœ¼ë¯€ë¡œ Import ì‹¤íŒ¨
- `DesignFactory`ì—ì„œ `TemplateSample1 = None` ì„¤ì •

**í•´ê²°**: `TemplateDesign`ì—ì„œ openpyxl Importë¥¼ ì„ íƒì ìœ¼ë¡œ ë§Œë“¤ê¸° (ì™„ë£Œ)

---

## âœ… ì ìš©ëœ í•´ê²° ë°©ë²•

### í•´ê²° 1: BaseDesignì˜ yaml Import ì„ íƒì  ì²˜ë¦¬

**ë³€ê²½ ì‚¬í•­**:
```python
# base_design.py
try:
    import yaml
    HAS_YAML = True
except ImportError:
    HAS_YAML = False
    yaml = None

def _load_config(self, config_path):
    if not HAS_YAML:
        return {}  # YAMLì´ ì—†ìœ¼ë©´ ë¹ˆ ë”•ì…”ë„ˆë¦¬ ë°˜í™˜
    # ... ê¸°ì¡´ ë¡œì§
```

**íš¨ê³¼**:
- `BaseDesign`ì´ yaml ì—†ì´ë„ Import ê°€ëŠ¥
- í…œí”Œë¦¿ ë””ìì¸ì€ YAMLì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ë¬¸ì œì—†ìŒ

### í•´ê²° 2: TemplateDesignì˜ openpyxl Import ì„ íƒì  ì²˜ë¦¬

**ë³€ê²½ ì‚¬í•­**:
```python
# template_design.py
try:
    import openpyxl
    HAS_OPENPYXL = True
except ImportError:
    HAS_OPENPYXL = False
    openpyxl = None

def generate_excel(self, ...):
    if not HAS_OPENPYXL:
        raise ImportError("openpyxl ëª¨ë“ˆì´ ì„¤ì¹˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
    # ... ê¸°ì¡´ ë¡œì§
```

**íš¨ê³¼**:
- `TemplateDesign`ì´ openpyxl ì—†ì´ë„ Import ê°€ëŠ¥
- ì‹¤ì œ ì‚¬ìš© ì‹œ ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€ ì œê³µ

### í•´ê²° 3: __init__.pyì˜ Import ì‹¤íŒ¨ ì²˜ë¦¬

**ë³€ê²½ ì‚¬í•­**:
```python
# __init__.py
try:
    from .base_design import BaseDesign
except ImportError:
    BaseDesign = None

try:
    from .design_factory import DesignFactory
except ImportError:
    DesignFactory = None
```

**íš¨ê³¼**:
- Import ì‹¤íŒ¨ ì‹œì—ë„ ë‹¤ë¥¸ í´ë˜ìŠ¤ Import ê°€ëŠ¥
- `design_factory.py`ì—ì„œ ì´ë¯¸ ì²˜ë¦¬í•˜ê³  ìˆìœ¼ë¯€ë¡œ ì¶”ê°€ ë³´í˜¸

---

## ğŸ”§ ìµœì¢… í•´ê²° ë°©ë²•

### ì¦‰ì‹œ í•´ê²° (í•„ìˆ˜)

**í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜**:
```bash
pip install PyYAML openpyxl
# ë˜ëŠ”
pip install -r requirements.txt
```

### ì½”ë“œ ìˆ˜ì • (ì™„ë£Œ)

1. âœ… `BaseDesign`ì—ì„œ yaml Import ì„ íƒì  ì²˜ë¦¬
2. âœ… `TemplateDesign`ì—ì„œ openpyxl Import ì„ íƒì  ì²˜ë¦¬
3. âœ… `__init__.py`ì—ì„œ Import ì‹¤íŒ¨ ì²˜ë¦¬

---

## ğŸ“Š ì˜ˆìƒ ê²°ê³¼

### ìˆ˜ì • ì „
```
Import ì‹¤íŒ¨ â†’ DesignFactory._designs['template_sample1'] = None
â†’ get_design()ì´ None ë°˜í™˜ â†’ ê¸°ë³¸ PDF ìƒì„±
```

### ìˆ˜ì • í›„ (íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì‹œ)
```
Import ì„±ê³µ â†’ DesignFactory._designs['template_sample1'] = TemplateSample1
â†’ get_design()ì´ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜ â†’ í…œí”Œë¦¿ PDF ìƒì„±
```

### ìˆ˜ì • í›„ (íŒ¨í‚¤ì§€ ë¯¸ì„¤ì¹˜ ì‹œ)
```
Import ì„±ê³µ (ì„ íƒì  ì²˜ë¦¬) â†’ get_design()ì´ ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜
â†’ generate_excel() í˜¸ì¶œ ì‹œ ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€
```

---

## ğŸ¯ ìµœì¢… í™•ì¸ ì‚¬í•­

### 1. íŒ¨í‚¤ì§€ ì„¤ì¹˜ í™•ì¸

```bash
python3 -c "import yaml; import openpyxl; print('âœ“ ëª¨ë“  ëª¨ë“ˆ ì„¤ì¹˜ë¨')"
```

### 2. Import í…ŒìŠ¤íŠ¸

```bash
python scripts/debug_template_design.py
```

### 3. ì‹¤ì œ ìƒì„± í…ŒìŠ¤íŠ¸

ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ:
1. [ë‹¨ì¼ì§ì›] â†’ [ë””ìì¸ ì„ íƒ] â†’ [í…œí”Œë¦¿1: ê¸‰ì—¬ëª…ì„¸ì„œ]
2. ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„±
3. ìƒì„±ëœ PDF í™•ì¸

---

## ğŸ“ ìš”ì•½

### ê·¼ë³¸ ì›ì¸
1. **yaml ëª¨ë“ˆ ì—†ìŒ** â†’ `BaseDesign` Import ì‹¤íŒ¨
2. **openpyxl ëª¨ë“ˆ ì—†ìŒ** â†’ `TemplateDesign` Import ì‹¤íŒ¨
3. **Import ì²´ì¸ ì‹¤íŒ¨** â†’ `TemplateSample1 = None`
4. **DesignFactory.get_design()ì´ None ë°˜í™˜** â†’ ê¸°ë³¸ PDF ìƒì„±

### í•´ê²° ë°©ë²•
1. âœ… ì½”ë“œ ìˆ˜ì •: Importë¥¼ ì„ íƒì ìœ¼ë¡œ ì²˜ë¦¬
2. âš ï¸ íŒ¨í‚¤ì§€ ì„¤ì¹˜: `pip install PyYAML openpyxl`
3. âœ… ì—ëŸ¬ ë©”ì‹œì§€ ê°œì„ : ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€ ì œê³µ

### ë‹¤ìŒ ë‹¨ê³„
1. íŒ¨í‚¤ì§€ ì„¤ì¹˜ í™•ì¸
2. ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ì‹œì‘
3. ì‹¤ì œ í…ŒìŠ¤íŠ¸

---

**ì‘ì„±ì**: AI Assistant  
**ì‘ì„±ì¼**: 2025-12-12  
**ìƒíƒœ**: âœ… ê·¼ë³¸ ì›ì¸ í™•ì¸ ë° í•´ê²° ë°©ë²• ì ìš© ì™„ë£Œ
