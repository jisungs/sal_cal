# 🎯 다음 진행 작업 가이드

**작성일**: 2025-12-11  
**기준**: `오늘_작업_계획.md` 및 `현재_상태_저장.md`  
**상태**: 코드 작성 완료, 테스트 및 검증 필요

---

## 📊 현재 상태 요약

### ✅ 완료된 작업
- 보안 설정 강화 (SECRET_KEY, DATABASE_URI 동적 설정)
- 세션 타임아웃 설정 (24시간)
- 에러 처리 개선 (구체적 예외 처리, 전역 에러 핸들러)
- 파일 정리 시스템 구현 (자동 삭제 스케줄러)
- 웹 직접 입력 기능 개선 (실시간 계산, 추천 기능)
- 테스트 코드 작성 (단위 테스트)

### ⚠️ 대기 중인 작업
- 실제 실행 테스트 (가상환경 활성화 필요)
- 통합 테스트 (브라우저 수동 테스트)
- 기능 검증 및 버그 수정

---

## 🎯 다음 진행 작업 (우선순위 순)

### 🔴 즉시 수행 (높은 우선순위)

#### 1. 테스트 실행 및 검증 ⭐

**목적**: 작성된 코드가 정상 작동하는지 확인

**작업 내용**:
```bash
# 1. 가상환경 활성화
source venv/bin/activate

# 2. 모든 단위 테스트 실행
python tests/run_all_tests.py

# 3. 개별 테스트 실행 (필요시)
python tests/test_config.py
python tests/test_cleanup.py
python tests/test_app_init.py
python tests/test_error_handlers.py
```

**확인 사항**:
- [ ] 모든 테스트 통과 확인
- [ ] 실패한 테스트가 있다면 원인 분석 및 수정
- [ ] 테스트 결과 문서화

**예상 소요 시간**: 30분 - 1시간

---

#### 2. Flask 앱 실행 및 기본 기능 확인 ⭐

**목적**: 개발 서버가 정상적으로 시작되고 기본 기능이 작동하는지 확인

**작업 내용**:
```bash
# 1. 가상환경 활성화
source venv/bin/activate

# 2. Flask 앱 실행
python app.py

# 또는
flask run
```

**확인 사항**:
- [ ] 앱이 정상적으로 시작되는지 확인
- [ ] 로그에서 파일 정리 스케줄러 등록 메시지 확인
- [ ] 홈페이지 접속 가능 여부 확인
- [ ] 기본 라우트 동작 확인 (/, /about, /contact 등)

**예상 소요 시간**: 15-30분

---

#### 3. 보안 설정 검증 ⭐

**목적**: SECRET_KEY 및 DATABASE_URI 동적 설정이 정상 작동하는지 확인

**작업 내용**:

**3-1. 개발 환경 테스트**:
```bash
# SECRET_KEY 없이 실행 (경고 메시지 확인)
unset SECRET_KEY
python app.py
# 경고 메시지가 표시되고 기본값으로 실행되는지 확인
```

**3-2. 프로덕션 환경 테스트**:
```bash
# SECRET_KEY 없이 프로덕션 모드 실행 (에러 발생 확인)
export FLASK_ENV=production
unset SECRET_KEY
python app.py
# ValueError 발생하는지 확인

# SECRET_KEY 설정 후 실행 (정상 작동 확인)
export SECRET_KEY=test-secret-key-for-production
export DATABASE_URL=sqlite:///test_production.db
python app.py
# 정상적으로 시작되는지 확인
```

**확인 사항**:
- [ ] 개발 환경에서 SECRET_KEY 없을 때 경고 메시지 표시
- [ ] 프로덕션 환경에서 SECRET_KEY 없을 때 에러 발생
- [ ] 프로덕션 환경에서 DATABASE_URL 없을 때 에러 발생
- [ ] 환경 변수 설정 후 정상 작동

**예상 소요 시간**: 20-30분

---

#### 4. 에러 핸들러 동작 확인 ⭐

**목적**: 개선된 에러 핸들러가 정상 작동하는지 확인

**작업 내용**:
브라우저에서 다음 URL 접속하여 에러 페이지 확인:
- `http://localhost:5000/nonexistent` (404 에러)
- 잘못된 파일 업로드 시도 (400 에러)
- 권한 없는 파일 접근 시도 (403 에러)

**확인 사항**:
- [ ] 404 에러 페이지 정상 표시
- [ ] 400 에러 메시지 사용자 친화적으로 표시
- [ ] 403 에러 메시지 정상 표시
- [ ] 에러 로그 정상 기록

**예상 소요 시간**: 20-30분

---

### 🟡 단기 개선 (중간 우선순위)

#### 5. 파일 정리 시스템 동작 확인

**목적**: 자동 파일 삭제 스케줄러가 정상 작동하는지 확인

**작업 내용**:

**5-1. 수동 테스트**:
```python
# Python 인터프리터에서 직접 테스트
from app.utils.cleanup import cleanup_old_files
result = cleanup_old_files(max_age_hours=0)  # 모든 파일 삭제
print(result)
```

**5-2. 실제 동작 확인**:
1. 오래된 파일 생성 (테스트용)
2. Flask 앱 실행
3. 로그에서 파일 정리 실행 메시지 확인
4. 파일이 실제로 삭제되었는지 확인

**확인 사항**:
- [ ] 스케줄러가 정상적으로 등록되는지 확인
- [ ] 파일 정리 함수가 정상 작동하는지 확인
- [ ] 로그에 정상적으로 기록되는지 확인
- [ ] 실제로 오래된 파일이 삭제되는지 확인

**예상 소요 시간**: 30분 - 1시간

---

#### 6. 웹 직접 입력 기능 통합 테스트

**목적**: 개선된 웹 직접 입력 기능이 정상 작동하는지 확인

**작업 내용**:
브라우저에서 다음 기능 테스트:
1. 단일 직원 입력 폼:
   - 기본급 입력 시 연장근무수당 추천값 표시 확인
   - 실시간 계산 미리보기 상세 내역 확인
   - 총지급액, 총공제액, 실수령액 표시 확인

2. 다중 직원 입력 폼:
   - 각 직원별 연장근무수당 추천 기능 확인
   - 실시간 계산 미리보기 확인
   - 여러 직원 추가/삭제 기능 확인

**확인 사항**:
- [ ] 연장근무수당 추천값 정확도 확인
- [ ] 실시간 계산 미리보기 정확도 확인
- [ ] UI/UX 개선 사항 확인
- [ ] 버그 발견 시 수정

**예상 소요 시간**: 1-2시간

---

#### 7. 세션 타임아웃 동작 확인

**목적**: 24시간 세션 타임아웃이 정상 작동하는지 확인

**작업 내용**:
1. 로그인 후 세션 쿠키 확인
2. 24시간 후 (또는 테스트를 위해 세션 타임아웃 시간을 짧게 설정) 세션 만료 확인
3. 세션 만료 시 로그인 페이지로 리다이렉트 확인

**확인 사항**:
- [ ] 세션 쿠키에 `permanent` 플래그 설정 확인
- [ ] 세션 타임아웃 시간 정확도 확인
- [ ] 세션 만료 시 적절한 처리 확인

**예상 소요 시간**: 30분 - 1시간

---

### 🟢 중장기 개선 (낮은 우선순위)

#### 8. 데이터베이스 쿼리 최적화

**목적**: N+1 쿼리 문제 해결 및 성능 개선

**작업 내용**:
- `app/utils/analytics.py`의 쿼리 최적화
- Eager loading 적용 (joinedload 사용)
- 인덱스 확인 및 추가

**예상 소요 시간**: 2-3시간

---

#### 9. 세션 데이터 크기 감소

**목적**: 세션 데이터 최적화

**작업 내용**:
- 세션에 저장하는 데이터 최소화
- `results` 리스트를 세션 대신 데이터베이스에 저장 검토
- 또는 결과를 파일로 저장하고 경로만 세션에 저장

**예상 소요 시간**: 2-3시간

---

#### 10. README 문서화 개선

**목적**: 환경 변수 설정 가이드 추가

**작업 내용**:
- README에 환경 변수 설정 가이드 추가
- 프로덕션 배포 가이드 추가

**예상 소요 시간**: 30분 - 1시간

---

## 📋 작업 체크리스트

### 즉시 수행 (오늘/내일)

- [ ] **1. 테스트 실행 및 검증**
  - [ ] 가상환경 활성화
  - [ ] 모든 단위 테스트 실행
  - [ ] 실패한 테스트 수정
  - [ ] 테스트 결과 문서화

- [ ] **2. Flask 앱 실행 및 기본 기능 확인**
  - [ ] 앱 정상 시작 확인
  - [ ] 기본 라우트 동작 확인
  - [ ] 로그 확인

- [ ] **3. 보안 설정 검증**
  - [ ] 개발 환경 SECRET_KEY 경고 확인
  - [ ] 프로덕션 환경 SECRET_KEY 에러 확인
  - [ ] DATABASE_URL 에러 확인
  - [ ] 환경 변수 설정 후 정상 작동 확인

- [ ] **4. 에러 핸들러 동작 확인**
  - [ ] 404 에러 페이지 확인
  - [ ] 400 에러 메시지 확인
  - [ ] 403 에러 메시지 확인
  - [ ] 에러 로그 확인

### 단기 개선 (이번 주)

- [ ] **5. 파일 정리 시스템 동작 확인**
  - [ ] 수동 테스트
  - [ ] 실제 동작 확인
  - [ ] 로그 확인

- [ ] **6. 웹 직접 입력 기능 통합 테스트**
  - [ ] 단일 직원 입력 폼 테스트
  - [ ] 다중 직원 입력 폼 테스트
  - [ ] 버그 수정

- [ ] **7. 세션 타임아웃 동작 확인**
  - [ ] 세션 쿠키 확인
  - [ ] 세션 만료 확인

### 중장기 개선 (다음 주 이후)

- [ ] **8. 데이터베이스 쿼리 최적화**
- [ ] **9. 세션 데이터 크기 감소**
- [ ] **10. README 문서화 개선**

---

## 🎯 권장 작업 순서

### 오늘/내일 (즉시 수행)

1. **테스트 실행** (30분 - 1시간)
   - 가상환경 활성화
   - 모든 테스트 실행
   - 실패한 테스트 수정

2. **Flask 앱 실행** (15-30분)
   - 기본 기능 확인
   - 로그 확인

3. **보안 설정 검증** (20-30분)
   - 개발/프로덕션 환경 테스트

4. **에러 핸들러 확인** (20-30분)
   - 브라우저에서 에러 페이지 확인

### 이번 주 (단기 개선)

5. **파일 정리 시스템 확인** (30분 - 1시간)
6. **웹 직접 입력 기능 테스트** (1-2시간)
7. **세션 타임아웃 확인** (30분 - 1시간)

### 다음 주 이후 (중장기 개선)

8. **데이터베이스 쿼리 최적화** (2-3시간)
9. **세션 데이터 크기 감소** (2-3시간)
10. **README 문서화 개선** (30분 - 1시간)

---

## 📝 작업 후 보고서 작성

각 작업 완료 후 다음 보고서 작성:
- `테스트_실행_결과_보고서.md` (1번 작업 후)
- `기능_검증_보고서.md` (2-7번 작업 후)
- `성능_개선_보고서.md` (8-9번 작업 후)

---

## ⚠️ 주의사항

### 테스트 실행 시
- 반드시 가상환경을 활성화한 후 실행
- 프로덕션 환경 테스트 시 DATABASE_URL 설정 필요
- 테스트 데이터베이스 사용 권장

### Flask 앱 실행 시
- 개발 환경에서는 SECRET_KEY 없이도 실행 가능 (경고 메시지)
- 프로덕션 환경에서는 SECRET_KEY와 DATABASE_URL 필수
- 로그 파일 확인하여 스케줄러 등록 확인

### 통합 테스트 시
- 실제 브라우저에서 테스트 권장
- 다양한 시나리오 테스트
- 발견된 버그는 즉시 수정

---

**작성자**: AI Assistant  
**작성일**: 2025-12-11  
**다음 업데이트**: 작업 진행 후
