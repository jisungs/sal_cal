# 📋 2025-12-11 오늘 작업 계획

**작성일**: 2025-12-11  
**기준 문서**: 
- `plan/2025-12-10/다음_진행사항_요약.md`
- `plan/2025-12-10/다음_단계_제안.md`
- `plan/2025-12-11/PROJECT_AUDIT_REPORT.md`

---

## 📊 현재 상태 요약

### ✅ 완료된 작업
- Phase 1: 프로젝트 구조 리팩토링 (100%)
- Phase 2: 사용자 인증 시스템 (100%)
- Phase 4 Day 1-2: 데이터 수집 시스템 모델 생성 (100%)
- 웹 직접 입력 기능 Phase 1, 2 (100%)

### ⚠️ 발견된 개선 사항 (점검 보고서)
- 보안 설정 강화 필요 (SECRET_KEY 환경 변수화)
- 파일 정리 시스템 필요
- 세션 타임아웃 설정 필요
- 에러 처리 개선 필요
- 테스트 코드 부재

---

## 🎯 오늘 작업 목표

**전략**: 점검 보고서의 높은 우선순위 개선 사항 + 웹 직접 입력 Phase 3 완성

---

## ✅ 투두 리스트

### 🔴 높은 우선순위 (즉시 조치)

#### 1. 보안 설정 강화 ✅
- [x] `config.py`에서 `SECRET_KEY` 환경 변수 필수화
  - [x] 프로덕션 환경에서 SECRET_KEY 없으면 에러 발생하도록 수정
  - [x] 개발 환경에서는 기본값 사용 (경고 메시지 포함)
  - [x] `.env.example` 파일에 SECRET_KEY 예시 추가 (이미 존재)
  - [ ] README에 환경 변수 설정 가이드 추가 (선택사항)

#### 2. 파일 정리 시스템 구현 ✅
- [x] 업로드 파일 자동 삭제 스케줄러 구현
  - [x] `app/utils/cleanup.py` 모듈 생성
  - [x] 24시간 이상 된 업로드 파일 삭제 함수 구현
  - [x] 임시 ZIP 파일 정리 함수 구현
  - [x] Flask 애플리케이션 시작 시 스케줄러 등록
  - [x] threading.Timer 사용
- [x] 파일 정리 로그 기록
- [ ] 테스트: 파일 생성 후 시간 경과 시 자동 삭제 확인 (실제 실행 테스트 필요)

#### 3. 세션 타임아웃 설정 ✅
- [x] `config.py`에 세션 타임아웃 설정 추가
  - [x] `PERMANENT_SESSION_LIFETIME` 설정 (24시간)
  - [x] 세션 쿠키 설정 확인
- [ ] 세션 만료 시 사용자에게 알림 메시지 표시 (Flask-Login 기본 동작 사용)
- [ ] 테스트: 세션 타임아웃 동작 확인 (실제 실행 테스트 필요)

#### 4. 에러 처리 개선 ✅
- [x] 구체적인 예외 처리 추가
  - [x] `app/routes/main.py`의 `upload_file()` 함수 개선
  - [x] `FileNotFoundError`, `PermissionError`, `ValueError` 등 구체적 예외 처리
  - [x] 에러 메시지 사용자 친화적으로 개선
- [x] 전역 에러 핸들러 강화
  - [x] 400, 403, 500 에러 핸들러 추가
  - [x] 에러 로깅 강화
- [ ] 테스트: 각 에러 케이스별 동작 확인 (실제 실행 테스트 필요)

---

### 🟡 중간 우선순위 (단기 개선)

#### 5. 웹 직접 입력 Phase 3 완성 ✅ (일부)
- [x] 입력 가이드/도움말 추가 (이미 구현되어 있음)
  - [x] 각 필드별 상세 설명 (form-text로 구현됨)
  - [x] 사용 예시 제공 (입력 가이드 섹션)
  - [x] FAQ 섹션 추가 (이미 구현됨)
- [x] 자동 계산 기능 개선
  - [x] 연장근무단가 권장값 자동 계산
    - [x] 기본급 기반 권장값 제시 (기본급/일근무시간 * 1.5)
    - [x] 사용자가 수정 가능하도록 구현
  - [x] 실시간 계산 미리보기 개선
    - [x] AJAX로 실시간 계산 결과 표시
    - [x] 입력 필드 변경 시 자동 업데이트
    - [x] 상세 계산 내역 표시 (지급/공제 내역)
- [x] 다중 입력 폼에도 자동 계산 기능 추가
- [ ] 테스트 및 버그 수정
  - [ ] 전체 기능 통합 테스트 (실제 실행 테스트 필요)
  - [ ] 사용자 시나리오 테스트 (실제 실행 테스트 필요)
  - [ ] 발견된 버그 수정

#### 6. 데이터베이스 쿼리 최적화
- [ ] N+1 쿼리 문제 해결
  - [ ] `app/utils/analytics.py`의 쿼리 최적화
  - [ ] Eager loading 적용 (joinedload 사용)
- [ ] 인덱스 확인 및 추가
  - [ ] 자주 조회되는 필드에 인덱스 추가
  - [ ] 복합 인덱스 검토

#### 7. 세션 데이터 크기 감소
- [ ] 세션에 저장하는 데이터 최소화
  - [ ] `results` 리스트를 세션 대신 데이터베이스에 저장 검토
  - [ ] 또는 결과를 파일로 저장하고 경로만 세션에 저장
- [ ] 세션 데이터 압축 검토

---

### 🟢 낮은 우선순위 (장기 개선)

#### 8. 테스트 코드 작성 (선택사항)
- [ ] pytest 설정 파일 생성
- [ ] 핵심 기능 단위 테스트 작성
  - [ ] 급여 계산 로직 테스트
  - [ ] 파일 업로드 테스트
  - [ ] 인증 기능 테스트
- [ ] 통합 테스트 작성

#### 9. 문서화 개선
- [ ] API 문서화 (선택사항)
  - [ ] Flask-RESTX 또는 Swagger 추가 검토
- [ ] 코드 주석 보완
- [ ] 사용자 가이드 업데이트

---

## ⏰ 예상 소요 시간

### 오늘 완료 목표 (4-6시간)
1. 보안 설정 강화: **30분**
2. 파일 정리 시스템: **1-2시간**
3. 세션 타임아웃 설정: **30분**
4. 에러 처리 개선: **1시간**
5. 웹 직접 입력 Phase 3 (일부): **1-2시간**

### 내일 이후 작업
- 웹 직접 입력 Phase 3 완성 (나머지)
- 데이터베이스 쿼리 최적화
- 테스트 코드 작성

---

## 📝 작업 순서

### 오전 (2-3시간)
1. ✅ 보안 설정 강화 (30분)
2. ✅ 세션 타임아웃 설정 (30분)
3. ✅ 에러 처리 개선 (1시간)
4. ✅ 파일 정리 시스템 설계 (30분)

### 오후 (2-3시간)
5. ✅ 파일 정리 시스템 구현 (1-2시간)
6. ✅ 웹 직접 입력 Phase 3 - 자동 계산 기능 (1시간)

### 저녁 (선택사항)
7. ✅ 웹 직접 입력 Phase 3 - 입력 가이드 추가 (1시간)
8. ✅ 테스트 및 버그 수정 (1시간)

---

## 🎯 오늘 완료 목표

### 필수 완료 항목
- [x] 보안 설정 강화
- [x] 세션 타임아웃 설정
- [x] 에러 처리 개선
- [x] 파일 정리 시스템 기본 구현

### 선택 완료 항목
- [x] 웹 직접 입력 Phase 3 - 자동 계산 기능 ✅
- [x] 웹 직접 입력 Phase 3 - 입력 가이드 ✅ (이미 구현되어 있었음)

---

## 📋 체크리스트

### 보안
- [x] SECRET_KEY 환경 변수화 완료 ✅
- [x] 세션 타임아웃 설정 완료 ✅
- [x] 에러 핸들러 전역 적용 완료 ✅

### 파일 관리
- [x] 파일 정리 스케줄러 구현 완료 ✅
- [ ] 테스트 완료 (실제 실행 테스트 필요)

### 기능 개선
- [x] 에러 처리 개선 완료 ✅
- [x] 웹 직접 입력 기능 개선 완료 ✅

### 테스트
- [ ] 각 기능별 동작 확인 완료
- [ ] 통합 테스트 완료

---

## 📝 작업 후 보고서 작성

각 작업 완료 후 다음 보고서 작성:
1. `보안_설정_강화_보고서.md` ✅
2. `파일_정리_시스템_구현_보고서.md` ✅
3. `세션_타임아웃_설정_보고서.md` ✅
4. `에러_처리_개선_보고서.md` ✅
5. `웹_직접입력_Phase3_완료_보고서.md` ✅

---

**작성자**: AI Assistant  
**작성일**: 2025-12-11  
**다음 업데이트**: 작업 완료 후
