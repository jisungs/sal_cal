# ğŸŒ ì›¹ ì§ì ‘ ì…ë ¥ ê¸°ëŠ¥ ì¶”ê°€ ê³„íš

**ëª©í‘œ**: ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ ì™¸ì— ì›¹ í¼ì„ í†µí•œ ì§ì ‘ ì…ë ¥ ê¸°ëŠ¥ ì¶”ê°€  
**ì‘ì„±ì¼**: 2025-12-10  
**ì‘ì„±ì**: AI Assistant (í”„ë¡œ ê°œë°œì ê´€ì )  
**ì˜ˆìƒ ì†Œìš” ì‹œê°„**: 2-3ì¼

---

## ğŸ“‹ ê°œìš”

### í˜„ì¬ ìƒíƒœ
- âœ… ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œë¥¼ í†µí•œ ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„± ê¸°ëŠ¥ ì™„ë£Œ
- âœ… ë‹¨ì¼/ë‹¤ì¤‘ ì§ì› ì²˜ë¦¬ ì§€ì›
- âœ… Excel/PDF ì¶œë ¥ í˜•ì‹ ì§€ì›

### ì¶”ê°€í•  ê¸°ëŠ¥
- âœ… ì›¹ í¼ì„ í†µí•œ ì§ì ‘ ì…ë ¥ ê¸°ëŠ¥
- âœ… ë‹¨ì¼ ì§ì› ì…ë ¥ (ê¸°ë³¸)
- âœ… ë‹¤ì¤‘ ì§ì› ì…ë ¥ (ê³ ê¸‰)
- âœ… ì‹¤ì‹œê°„ ê³„ì‚° ë¯¸ë¦¬ë³´ê¸°
- âœ… ì…ë ¥ ë°ì´í„° ê²€ì¦

---

## ğŸ¯ ìš”êµ¬ì‚¬í•­ ë¶„ì„

### ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤

#### ì‹œë‚˜ë¦¬ì˜¤ 1: ë‹¨ì¼ ì§ì› ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„±
- ì‚¬ìš©ìê°€ ì›¹ í¼ì— ì§ì› ì •ë³´ë¥¼ ì§ì ‘ ì…ë ¥
- ì‹¤ì‹œê°„ìœ¼ë¡œ ê³„ì‚° ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°
- ì…ë ¥ ì™„ë£Œ í›„ ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„±

#### ì‹œë‚˜ë¦¬ì˜¤ 2: ë‹¤ì¤‘ ì§ì› ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„±
- ì—¬ëŸ¬ ì§ì› ì •ë³´ë¥¼ í•œ ë²ˆì— ì…ë ¥
- ì§ì› ì¶”ê°€/ì‚­ì œ ê¸°ëŠ¥
- ì¼ê´„ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ

### ê¸°ëŠ¥ ìš°ì„ ìˆœìœ„

#### P0 (í•„ìˆ˜)
1. ë‹¨ì¼ ì§ì› ì…ë ¥ í¼
2. í•„ìˆ˜ í•„ë“œ ê²€ì¦
3. ê³„ì‚° ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°
4. ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ

#### P1 (ê¶Œì¥)
1. ë‹¤ì¤‘ ì§ì› ì…ë ¥ (ì§ì› ì¶”ê°€/ì‚­ì œ)
2. ì…ë ¥ ë°ì´í„° ì €ì¥ (ì„¸ì…˜)
3. ì…ë ¥ ì´ë ¥ ê´€ë¦¬

#### P2 (ì„ íƒ)
1. ì…ë ¥ í…œí”Œë¦¿ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸°
2. ì—‘ì…€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
3. ì…ë ¥ ê°€ì´ë“œ/ë„ì›€ë§

---

## ğŸ—ï¸ ê¸°ìˆ  ì„¤ê³„

### 1. ì•„í‚¤í…ì²˜

```
[ì›¹ í¼ ì…ë ¥] â†’ [ì„œë²„ ê²€ì¦] â†’ [ê¸‰ì—¬ ê³„ì‚°] â†’ [ê²°ê³¼ ì €ì¥] â†’ [íŒŒì¼ ìƒì„±] â†’ [ë‹¤ìš´ë¡œë“œ]
     â†“              â†“              â†“              â†“              â†“
[ì‹¤ì‹œê°„ ê²€ì¦]  [WTForms]    [Calculator]   [Session]    [Excel/PDF]
```

### 2. ë°ì´í„° êµ¬ì¡°

#### ì…ë ¥ í•„ë“œ (í•„ìˆ˜)
```python
í•„ìˆ˜ í•„ë“œ:
- ì´ë¦„ (string, 1-50ì)
- ì£¼ë¯¼ë²ˆí˜¸ (string, 6ìë¦¬ ìˆ«ì)
- ì…ì‚¬ì¼ (date, YYYY-MM-DD)
- ê¸°ë³¸ê¸‰ (integer, 0 ì´ìƒ)
- ë¶€ì–‘ê°€ì¡±ìˆ˜ (integer, 0-10)

ì„ íƒ í•„ë“œ:
- ê³„ì¢Œë²ˆí˜¸ (string, í˜•ì‹ ê²€ì¦)
- ì—°ì¥ê·¼ë¬´ì‹œê°„ (integer, 0 ì´ìƒ)
- ì—°ì¥ê·¼ë¬´ë‹¨ê°€ (integer, 0 ì´ìƒ)
- ìƒì—¬ê¸ˆ (integer, 0 ì´ìƒ)
- ê³µì œì‚¬í•­ (string, ìµœëŒ€ 200ì)
```

### 3. ë¼ìš°íŠ¸ ì„¤ê³„

```
GET  /input              - ì…ë ¥ í¼ í˜ì´ì§€
POST /input              - ë‹¨ì¼ ì§ì› ì…ë ¥ ì²˜ë¦¬
GET  /input/multiple     - ë‹¤ì¤‘ ì§ì› ì…ë ¥ í¼
POST /input/multiple     - ë‹¤ì¤‘ ì§ì› ì…ë ¥ ì²˜ë¦¬
POST /input/preview      - ì‹¤ì‹œê°„ ê³„ì‚° ë¯¸ë¦¬ë³´ê¸° (AJAX)
GET  /input/template     - ì—‘ì…€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
```

---

## ğŸ“ êµ¬í˜„ ê³„íš

### Phase 1: ê¸°ë³¸ í¼ ë° ê²€ì¦ (Day 1)

#### 1-1. WTForms í¼ í´ë˜ìŠ¤ ìƒì„±
**íŒŒì¼**: `app/forms/payroll_forms.py`

```python
from flask_wtf import FlaskForm
from wtforms import StringField, IntegerField, DateField, TextAreaField, SubmitField
from wtforms.validators import DataRequired, Length, NumberRange, Optional, Regexp
from datetime import datetime

class EmployeeInputForm(FlaskForm):
    """ì§ì› ì •ë³´ ì…ë ¥ í¼"""
    
    # í•„ìˆ˜ í•„ë“œ
    name = StringField('ì´ë¦„', validators=[
        DataRequired(message='ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'),
        Length(min=1, max=50, message='ì´ë¦„ì€ 1-50ì ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.')
    ])
    
    resident_number = StringField('ì£¼ë¯¼ë²ˆí˜¸ ì•ìë¦¬', validators=[
        DataRequired(message='ì£¼ë¯¼ë²ˆí˜¸ ì•ìë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'),
        Regexp(r'^\d{6}$', message='ì£¼ë¯¼ë²ˆí˜¸ ì•ìë¦¬ëŠ” 6ìë¦¬ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤.')
    ])
    
    hire_date = DateField('ì…ì‚¬ì¼', validators=[
        DataRequired(message='ì…ì‚¬ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.')
    ], format='%Y-%m-%d')
    
    base_salary = IntegerField('ê¸°ë³¸ê¸‰ (ì›)', validators=[
        DataRequired(message='ê¸°ë³¸ê¸‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'),
        NumberRange(min=0, message='ê¸°ë³¸ê¸‰ì€ 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.')
    ])
    
    dependents = IntegerField('ë¶€ì–‘ê°€ì¡±ìˆ˜', validators=[
        DataRequired(message='ë¶€ì–‘ê°€ì¡±ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'),
        NumberRange(min=0, max=10, message='ë¶€ì–‘ê°€ì¡±ìˆ˜ëŠ” 0-10 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.')
    ], default=0)
    
    # ì„ íƒ í•„ë“œ
    account_number = StringField('ê³„ì¢Œë²ˆí˜¸', validators=[
        Optional(),
        Length(max=50, message='ê³„ì¢Œë²ˆí˜¸ëŠ” 50ì ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.')
    ])
    
    overtime_hours = IntegerField('ì—°ì¥ê·¼ë¬´ì‹œê°„', validators=[
        Optional(),
        NumberRange(min=0, message='ì—°ì¥ê·¼ë¬´ì‹œê°„ì€ 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.')
    ], default=0)
    
    overtime_rate = IntegerField('ì—°ì¥ê·¼ë¬´ë‹¨ê°€ (ì›/ì‹œê°„)', validators=[
        Optional(),
        NumberRange(min=0, message='ì—°ì¥ê·¼ë¬´ë‹¨ê°€ëŠ” 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.')
    ], default=0)
    
    bonus = IntegerField('ìƒì—¬ê¸ˆ (ì›)', validators=[
        Optional(),
        NumberRange(min=0, message='ìƒì—¬ê¸ˆì€ 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.')
    ], default=0)
    
    deduction_note = TextAreaField('ê³µì œì‚¬í•­ ë©”ëª¨', validators=[
        Optional(),
        Length(max=200, message='ê³µì œì‚¬í•­ ë©”ëª¨ëŠ” 200ì ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.')
    ])
    
    period = StringField('ì§€ê¸‰ ê¸°ê°„', validators=[
        DataRequired(message='ì§€ê¸‰ ê¸°ê°„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'),
        Regexp(r'^\d{4}-\d{2}$', message='ì§€ê¸‰ ê¸°ê°„ì€ YYYY-MM í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤.')
    ], default=lambda: datetime.now().strftime('%Y-%m'))
    
    output_format = StringField('ì¶œë ¥ í˜•ì‹', validators=[
        DataRequired()
    ], default='both')
    
    submit = SubmitField('ê¸‰ì—¬ëª…ì„¸ì„œ ìƒì„±')
```

#### 1-2. ë¼ìš°íŠ¸ êµ¬í˜„
**íŒŒì¼**: `app/routes/payroll.py` (ìƒˆ íŒŒì¼)

```python
from flask import Blueprint, render_template, request, jsonify, session, current_app
from flask_login import current_user
from app.forms.payroll_forms import EmployeeInputForm
from payroll_generator.calculator import PayrollCalculator
from app.utils.analytics import log_activity, log_payroll_calculation, calculate_totals_from_results

payroll_bp = Blueprint('payroll', __name__, url_prefix='/input')

@payroll_bp.route('/', methods=['GET', 'POST'])
def input_form():
    """ë‹¨ì¼ ì§ì› ì…ë ¥ í¼"""
    form = EmployeeInputForm()
    
    if form.validate_on_submit():
        # í¼ ë°ì´í„°ë¥¼ ë”•ì…”ë„ˆë¦¬ë¡œ ë³€í™˜
        employee_data = {
            'ì´ë¦„': form.name.data,
            'ì£¼ë¯¼ë²ˆí˜¸': form.resident_number.data,
            'ì…ì‚¬ì¼': form.hire_date.data.strftime('%Y-%m-%d'),
            'ê¸°ë³¸ê¸‰': form.base_salary.data,
            'ë¶€ì–‘ê°€ì¡±ìˆ˜': form.dependents.data,
            'ê³„ì¢Œë²ˆí˜¸': form.account_number.data or '',
            'ì—°ì¥ê·¼ë¬´ì‹œê°„': form.overtime_hours.data or 0,
            'ì—°ì¥ê·¼ë¬´ë‹¨ê°€': form.overtime_rate.data or 0,
            'ìƒì—¬ê¸ˆ': form.bonus.data or 0,
            'ê³µì œì‚¬í•­': form.deduction_note.data or ''
        }
        
        # ê¸‰ì—¬ ê³„ì‚°
        calculator = PayrollCalculator()
        payroll_data = calculator.calculate_deductions(employee_data)
        
        # ê²°ê³¼ë¥¼ ì„¸ì…˜ì— ì €ì¥
        results = [{
            'employee_name': employee_data['ì´ë¦„'],
            'payroll_data': payroll_data,
            'employee_data': employee_data
        }]
        
        session['results'] = results
        session['period'] = form.period.data
        session['output_format'] = form.output_format.data
        session['input_method'] = 'web_form'  # ì…ë ¥ ë°©ë²• í‘œì‹œ
        
        # ë°ì´í„° ìˆ˜ì§‘
        user_id = current_user.id if current_user.is_authenticated else None
        totals = calculate_totals_from_results(results)
        calculation_data = {
            'employee_count': 1,
            'period': form.period.data,
            'total_payroll': totals['total_payroll'],
            'total_deductions': totals['total_deductions'],
            'total_net_pay': totals['total_net_pay'],
            'results': results
        }
        log_payroll_calculation(user_id, calculation_data)
        log_activity(user_id, 'web_form_input', {'employee_count': 1})
        
        # ê²°ê³¼ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
        return redirect(url_for('main.result', session_id=session.get('session_id', 'web_input')))
    
    # GET ìš”ì²­ ì‹œ í¼ í‘œì‹œ
    return render_template('payroll/input_form.html', form=form)

@payroll_bp.route('/preview', methods=['POST'])
def preview_calculation():
    """ì‹¤ì‹œê°„ ê³„ì‚° ë¯¸ë¦¬ë³´ê¸° (AJAX)"""
    try:
        data = request.get_json()
        
        # ì…ë ¥ ë°ì´í„° ê²€ì¦
        employee_data = {
            'ê¸°ë³¸ê¸‰': data.get('base_salary', 0),
            'ì—°ì¥ê·¼ë¬´ì‹œê°„': data.get('overtime_hours', 0),
            'ì—°ì¥ê·¼ë¬´ë‹¨ê°€': data.get('overtime_rate', 0),
            'ìƒì—¬ê¸ˆ': data.get('bonus', 0),
            'ë¶€ì–‘ê°€ì¡±ìˆ˜': data.get('dependents', 0)
        }
        
        # ê¸‰ì—¬ ê³„ì‚°
        calculator = PayrollCalculator()
        payroll_data = calculator.calculate_deductions(employee_data)
        
        return jsonify({
            'success': True,
            'payroll_data': payroll_data
        })
    except Exception as e:
        return jsonify({
            'success': False,
            'error': str(e)
        }), 400
```

#### 1-3. í…œí”Œë¦¿ ìƒì„±
**íŒŒì¼**: `web/templates/payroll/input_form.html`

```html
{% extends "base.html" %}

{% block title %}ê¸‰ì—¬ëª…ì„¸ì„œ ì§ì ‘ ì…ë ¥{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-10">
        <div class="card shadow">
            <div class="card-header bg-primary text-white">
                <h3 class="card-title mb-0">âœï¸ ê¸‰ì—¬ëª…ì„¸ì„œ ì§ì ‘ ì…ë ¥</h3>
            </div>
            <div class="card-body">
                <form method="POST" id="payrollForm">
                    {{ form.hidden_tag() }}
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h5 class="mb-3">ê¸°ë³¸ ì •ë³´</h5>
                            
                            <div class="mb-3">
                                {{ form.name.label(class="form-label") }}
                                {{ form.name(class="form-control" + (" is-invalid" if form.name.errors else "")) }}
                                {% if form.name.errors %}
                                    <div class="invalid-feedback">
                                        {% for error in form.name.errors %}{{ error }}{% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="mb-3">
                                {{ form.resident_number.label(class="form-label") }}
                                {{ form.resident_number(class="form-control" + (" is-invalid" if form.resident_number.errors else ""), placeholder="123456") }}
                                {% if form.resident_number.errors %}
                                    <div class="invalid-feedback">
                                        {% for error in form.resident_number.errors %}{{ error }}{% endfor %}
                                    </div>
                                {% endif %}
                                <div class="form-text">ì£¼ë¯¼ë²ˆí˜¸ ì•ìë¦¬ 6ìë¦¬ë§Œ ì…ë ¥í•˜ì„¸ìš”.</div>
                            </div>
                            
                            <div class="mb-3">
                                {{ form.hire_date.label(class="form-label") }}
                                {{ form.hire_date(class="form-control" + (" is-invalid" if form.hire_date.errors else ""), type="date") }}
                                {% if form.hire_date.errors %}
                                    <div class="invalid-feedback">
                                        {% for error in form.hire_date.errors %}{{ error }}{% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="mb-3">
                                {{ form.account_number.label(class="form-label") }}
                                {{ form.account_number(class="form-control", placeholder="123-456-789012") }}
                                <div class="form-text">ì„ íƒì‚¬í•­: ê¸‰ì—¬ ì´ì²´ìš© ê³„ì¢Œë²ˆí˜¸</div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <h5 class="mb-3">ê¸‰ì—¬ ì •ë³´</h5>
                            
                            <div class="mb-3">
                                {{ form.base_salary.label(class="form-label") }}
                                {{ form.base_salary(class="form-control" + (" is-invalid" if form.base_salary.errors else ""), type="number", min="0", step="1000") }}
                                {% if form.base_salary.errors %}
                                    <div class="invalid-feedback">
                                        {% for error in form.base_salary.errors %}{{ error }}{% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="mb-3">
                                {{ form.dependents.label(class="form-label") }}
                                {{ form.dependents(class="form-control" + (" is-invalid" if form.dependents.errors else ""), type="number", min="0", max="10") }}
                                {% if form.dependents.errors %}
                                    <div class="invalid-feedback">
                                        {% for error in form.dependents.errors %}{{ error }}{% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="mb-3">
                                {{ form.overtime_hours.label(class="form-label") }}
                                {{ form.overtime_hours(class="form-control", type="number", min="0") }}
                                <div class="form-text">ì„ íƒì‚¬í•­: ì›” ì—°ì¥ê·¼ë¬´ ì‹œê°„</div>
                            </div>
                            
                            <div class="mb-3">
                                {{ form.overtime_rate.label(class="form-label") }}
                                {{ form.overtime_rate(class="form-control", type="number", min="0", step="1000") }}
                                <div class="form-text">ì„ íƒì‚¬í•­: ì‹œê°„ë‹¹ ì—°ì¥ê·¼ë¬´ ë‹¨ê°€</div>
                            </div>
                            
                            <div class="mb-3">
                                {{ form.bonus.label(class="form-label") }}
                                {{ form.bonus(class="form-control", type="number", min="0", step="1000") }}
                                <div class="form-text">ì„ íƒì‚¬í•­: ìƒì—¬ê¸ˆ ê¸ˆì•¡</div>
                            </div>
                        </div>
                    </div>
                    
                    <hr>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                {{ form.period.label(class="form-label") }}
                                {{ form.period(class="form-control" + (" is-invalid" if form.period.errors else ""), placeholder="2025-01") }}
                                {% if form.period.errors %}
                                    <div class="invalid-feedback">
                                        {% for error in form.period.errors %}{{ error }}{% endfor %}
                                    </div>
                                {% endif %}
                                <div class="form-text">í˜•ì‹: YYYY-MM</div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">ì¶œë ¥ í˜•ì‹</label>
                                <div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="output_format" 
                                               id="format_excel" value="excel">
                                        <label class="form-check-label" for="format_excel">ì—‘ì…€</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="output_format" 
                                               id="format_pdf" value="pdf">
                                        <label class="form-check-label" for="format_pdf">PDF</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="output_format" 
                                               id="format_both" value="both" checked>
                                        <label class="form-check-label" for="format_both">ë‘˜ ë‹¤</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        {{ form.deduction_note.label(class="form-label") }}
                        {{ form.deduction_note(class="form-control", rows="2", maxlength="200") }}
                        <div class="form-text">ì„ íƒì‚¬í•­: ê¸°íƒ€ ê³µì œì‚¬í•­ ë©”ëª¨ (ìµœëŒ€ 200ì)</div>
                    </div>
                    
                    <!-- ì‹¤ì‹œê°„ ê³„ì‚° ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ -->
                    <div id="previewArea" class="card bg-light mb-3 d-none">
                        <div class="card-body">
                            <h6 class="card-title">ğŸ’° ê³„ì‚° ë¯¸ë¦¬ë³´ê¸°</h6>
                            <div id="previewContent"></div>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2">
                        {{ form.submit(class="btn btn-primary btn-lg") }}
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/payroll_input.js') }}"></script>
{% endblock %}
```

#### 1-4. JavaScript ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°
**íŒŒì¼**: `web/static/js/payroll_input.js`

```javascript
// ì‹¤ì‹œê°„ ê³„ì‚° ë¯¸ë¦¬ë³´ê¸°
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('payrollForm');
    const previewArea = document.getElementById('previewArea');
    const previewContent = document.getElementById('previewContent');
    
    const fields = ['base_salary', 'overtime_hours', 'overtime_rate', 'bonus', 'dependents'];
    let previewTimeout;
    
    fields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        if (field) {
            field.addEventListener('input', function() {
                clearTimeout(previewTimeout);
                previewTimeout = setTimeout(updatePreview, 500); // 500ms ë””ë°”ìš´ìŠ¤
            });
        }
    });
    
    function updatePreview() {
        const data = {
            base_salary: parseInt(document.getElementById('base_salary').value) || 0,
            overtime_hours: parseInt(document.getElementById('overtime_hours').value) || 0,
            overtime_rate: parseInt(document.getElementById('overtime_rate').value) || 0,
            bonus: parseInt(document.getElementById('bonus').value) || 0,
            dependents: parseInt(document.getElementById('dependents').value) || 0
        };
        
        // ìµœì†Œí•œ ê¸°ë³¸ê¸‰ì´ ìˆì–´ì•¼ ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
        if (data.base_salary <= 0) {
            previewArea.classList.add('d-none');
            return;
        }
        
        fetch('/input/preview', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
        })
        .then(response => response.json())
        .then(result => {
            if (result.success) {
                const pd = result.payroll_data;
                previewContent.innerHTML = `
                    <div class="row">
                        <div class="col-md-6">
                            <strong>ì´ ì§€ê¸‰ì•¡:</strong> ${pd.ì´ì§€ê¸‰ì•¡?.toLocaleString() || 0}ì›<br>
                            <strong>ì´ ê³µì œì•¡:</strong> ${pd.ì´ê³µì œì•¡?.toLocaleString() || 0}ì›<br>
                        </div>
                        <div class="col-md-6">
                            <strong>ì‹¤ìˆ˜ë ¹ì•¡:</strong> <span class="text-primary fs-5">${pd.ì‹¤ìˆ˜ë ¹ì•¡?.toLocaleString() || 0}ì›</span>
                        </div>
                    </div>
                `;
                previewArea.classList.remove('d-none');
            }
        })
        .catch(error => {
            console.error('ë¯¸ë¦¬ë³´ê¸° ì˜¤ë¥˜:', error);
        });
    }
});
```

### Phase 2: ë‹¤ì¤‘ ì§ì› ì…ë ¥ (Day 2)

#### 2-1. ë‹¤ì¤‘ ì§ì› ì…ë ¥ í¼
- JavaScriptë¡œ ì§ì› ì¶”ê°€/ì‚­ì œ ê¸°ëŠ¥
- ê° ì§ì›ë³„ ì…ë ¥ í¼ ë™ì  ìƒì„±
- ì¼ê´„ ê²€ì¦ ë° ì²˜ë¦¬

#### 2-2. ì„¸ì…˜ ê´€ë¦¬
- ì…ë ¥í•œ ì§ì› ì •ë³´ë¥¼ ì„¸ì…˜ì— ì €ì¥
- ìˆ˜ì •/ì‚­ì œ ê¸°ëŠ¥ ì§€ì›

### Phase 3: í†µí•© ë° ê°œì„  (Day 3)

#### 3-1. ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´ ì¶”ê°€
- ë©”ì¸ í˜ì´ì§€ì— "ì§ì ‘ ì…ë ¥" ë©”ë‰´ ì¶”ê°€
- ì—‘ì…€ ì—…ë¡œë“œì™€ ì§ì ‘ ì…ë ¥ ì„ íƒ ê°€ëŠ¥

#### 3-2. ì‚¬ìš©ì ê²½í—˜ ê°œì„ 
- ì…ë ¥ ê°€ì´ë“œ ì¶”ê°€
- ìë™ ê³„ì‚° ê¸°ëŠ¥ (ì—°ì¥ê·¼ë¬´ë‹¨ê°€ ê¶Œì¥ê°’)
- ì…ë ¥ ì´ë ¥ ì €ì¥ (ì„ íƒì‚¬í•­)

---

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
app/
â”œâ”€â”€ forms/
â”‚   â””â”€â”€ payroll_forms.py          # ìƒˆ íŒŒì¼: ê¸‰ì—¬ ì…ë ¥ í¼
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ payroll.py                # ìƒˆ íŒŒì¼: ì§ì ‘ ì…ë ¥ ë¼ìš°íŠ¸
web/
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ payroll/
â”‚       â”œâ”€â”€ input_form.html        # ìƒˆ íŒŒì¼: ë‹¨ì¼ ì§ì› ì…ë ¥ í¼
â”‚       â””â”€â”€ multiple_input.html    # ìƒˆ íŒŒì¼: ë‹¤ì¤‘ ì§ì› ì…ë ¥ í¼
â””â”€â”€ static/
    â””â”€â”€ js/
        â””â”€â”€ payroll_input.js       # ìƒˆ íŒŒì¼: ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸° JS
```

---

## âœ… êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

### Phase 1: ê¸°ë³¸ ê¸°ëŠ¥
- [ ] `app/forms/payroll_forms.py` ìƒì„±
- [ ] `app/routes/payroll.py` ìƒì„± ë° Blueprint ë“±ë¡
- [ ] `web/templates/payroll/input_form.html` ìƒì„±
- [ ] `web/static/js/payroll_input.js` ìƒì„±
- [ ] ì‹¤ì‹œê°„ ê³„ì‚° ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥
- [ ] ê¸°ì¡´ ê²°ê³¼ í˜ì´ì§€ì™€ í†µí•©
- [ ] ë°ì´í„° ìˆ˜ì§‘ ë¡œì§ í†µí•©

### Phase 2: ë‹¤ì¤‘ ì§ì› ì…ë ¥
- [ ] ë‹¤ì¤‘ ì§ì› ì…ë ¥ í¼ í…œí”Œë¦¿
- [ ] JavaScript ë™ì  í¼ ìƒì„±
- [ ] ì¼ê´„ ê²€ì¦ ë° ì²˜ë¦¬

### Phase 3: í†µí•© ë° ê°œì„ 
- [ ] ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´ì— "ì§ì ‘ ì…ë ¥" ì¶”ê°€
- [ ] ì…ë ¥ ê°€ì´ë“œ/ë„ì›€ë§ ì¶”ê°€
- [ ] ìë™ ê³„ì‚° ê¸°ëŠ¥ (ì—°ì¥ê·¼ë¬´ë‹¨ê°€ ê¶Œì¥ê°’)
- [ ] í…ŒìŠ¤íŠ¸ ë° ë²„ê·¸ ìˆ˜ì •

---

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

1. **ì…ë ¥ ê²€ì¦**
   - ì„œë²„ ì‚¬ì´ë“œ ê²€ì¦ í•„ìˆ˜ (WTForms)
   - í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ê²€ì¦ì€ ë³´ì¡°ì 
   - SQL Injection ë°©ì§€ (ORM ì‚¬ìš©)

2. **ë°ì´í„° ë³´í˜¸**
   - ì£¼ë¯¼ë²ˆí˜¸ ë§ˆìŠ¤í‚¹ ì²˜ë¦¬
   - ì„¸ì…˜ ë°ì´í„° ì•”í˜¸í™”
   - CSRF ë³´í˜¸ (Flask-WTF ê¸°ë³¸ ì œê³µ)

3. **ì—ëŸ¬ ì²˜ë¦¬**
   - ì‚¬ìš©ì ì¹œí™”ì  ì—ëŸ¬ ë©”ì‹œì§€
   - ë¯¼ê°í•œ ì •ë³´ ë…¸ì¶œ ë°©ì§€

---

## ğŸ“Š ì˜ˆìƒ ì†Œìš” ì‹œê°„

| ì‘ì—… | ì˜ˆìƒ ì‹œê°„ | ìš°ì„ ìˆœìœ„ |
|------|----------|---------|
| Phase 1: ê¸°ë³¸ í¼ ë° ê²€ì¦ | 4-6ì‹œê°„ | P0 |
| Phase 2: ë‹¤ì¤‘ ì§ì› ì…ë ¥ | 3-4ì‹œê°„ | P1 |
| Phase 3: í†µí•© ë° ê°œì„  | 2-3ì‹œê°„ | P1 |
| **ì´ê³„** | **9-13ì‹œê°„** | |

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

1. **ì¦‰ì‹œ ì‹œì‘**: Phase 1ë¶€í„° ìˆœì°¨ì ìœ¼ë¡œ ì§„í–‰
2. **ì½”ë“œ ë¦¬ë·°**: ê° Phase ì™„ë£Œ í›„ ì½”ë“œ ê²€í† 
3. **ì‚¬ìš©ì í…ŒìŠ¤íŠ¸**: ì™„ì„± í›„ ì‹¤ì œ ì‚¬ìš©ì í…ŒìŠ¤íŠ¸
4. **í”¼ë“œë°± ë°˜ì˜**: ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘ ë° ê°œì„ 

---

## ğŸ“ ì°¸ê³ ì‚¬í•­

1. **ê¸°ì¡´ ì½”ë“œ ì¬ì‚¬ìš©**
   - `PayrollCalculator` í´ë˜ìŠ¤ ì¬ì‚¬ìš©
   - `ExcelHandler`, `PDFGenerator` ì¬ì‚¬ìš©
   - ê¸°ì¡´ ê²°ê³¼ í˜ì´ì§€ ì¬ì‚¬ìš©

2. **ë°ì´í„° í˜¸í™˜ì„±**
   - ì›¹ ì…ë ¥ ë°ì´í„°ë¥¼ ì—‘ì…€ ì…ë ¥ê³¼ ë™ì¼í•œ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
   - ê¸°ì¡´ ê³„ì‚° ë¡œì§ ê·¸ëŒ€ë¡œ ì‚¬ìš©

3. **ì‚¬ìš©ì ê²½í—˜**
   - ì‹¤ì‹œê°„ ê³„ì‚° ë¯¸ë¦¬ë³´ê¸°ë¡œ ì‚¬ìš©ì í¸ì˜ì„± í–¥ìƒ
   - ì…ë ¥ ê°€ì´ë“œë¡œ ì˜¤ë¥˜ ë°©ì§€
   - ë°˜ì‘í˜• ë””ìì¸ìœ¼ë¡œ ëª¨ë°”ì¼ ì§€ì›

---

**ì‘ì„±ì**: AI Assistant  
**ì‘ì„±ì¼**: 2025-12-10  
**ë²„ì „**: 1.0

