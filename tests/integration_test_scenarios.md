# 🧪 통합 테스트 시나리오

**작성일**: 2025-12-11  
**목적**: 구현된 기능들의 통합 테스트 시나리오

---

## 📋 테스트 환경 준비

### 필수 사항
1. 가상환경 활성화
   ```bash
   source venv/bin/activate  # macOS/Linux
   # 또는
   venv\Scripts\activate  # Windows
   ```

2. 의존성 설치 확인
   ```bash
   pip install -r requirements-web.txt
   ```

3. 데이터베이스 마이그레이션
   ```bash
   flask db upgrade
   ```

---

## 🧪 테스트 시나리오

### 1. 보안 설정 테스트

#### 1.1 개발 환경 SECRET_KEY 테스트
```bash
# SECRET_KEY 없이 실행
unset SECRET_KEY  # macOS/Linux
python app.py
```
**예상 결과**: 
- 경고 메시지 표시
- 기본값으로 정상 작동

#### 1.2 프로덕션 환경 SECRET_KEY 테스트
```bash
# SECRET_KEY 없이 프로덕션 모드 실행
export FLASK_ENV=production
unset SECRET_KEY
python app.py
```
**예상 결과**: 
- ValueError 발생
- 앱 시작 실패

```bash
# SECRET_KEY 설정 후 실행
export SECRET_KEY=test-secret-key-12345
python app.py
```
**예상 결과**: 
- 정상 작동

---

### 2. 세션 타임아웃 테스트

#### 2.1 세션 타임아웃 설정 확인
1. Flask 앱 실행
2. 브라우저에서 로그인
3. 24시간 후 세션 만료 확인

**예상 결과**: 
- 24시간 후 자동 로그아웃
- 세션 쿠키 만료

---

### 3. 에러 처리 테스트

#### 3.1 404 에러 테스트
```bash
curl http://localhost:5001/nonexistent-page
```
**예상 결과**: 
- 404 상태 코드
- 에러 페이지 표시

#### 3.2 파일 업로드 에러 테스트
1. 잘못된 형식 파일 업로드
2. 너무 큰 파일 업로드 (16MB 초과)
3. 존재하지 않는 파일 경로

**예상 결과**: 
- 적절한 에러 메시지
- 400 또는 404 상태 코드

#### 3.3 권한 에러 테스트
1. 읽기 권한 없는 파일 업로드 시도

**예상 결과**: 
- 403 상태 코드
- 적절한 에러 메시지

---

### 4. 파일 정리 시스템 테스트

#### 4.1 파일 정리 함수 테스트
```bash
python tests/test_cleanup.py
```
**예상 결과**: 
- 모든 테스트 통과

#### 4.2 스케줄러 동작 테스트
1. Flask 앱 실행
2. 로그에서 스케줄러 등록 메시지 확인
3. 1시간 후 첫 실행 확인 (또는 테스트용으로 시간 조정)

**예상 결과**: 
- 스케줄러 등록 메시지 표시
- 주기적 실행 확인

#### 4.3 파일 삭제 테스트
1. 오래된 파일 생성 (25시간 전)
2. 파일 정리 함수 실행
3. 파일 삭제 확인

**예상 결과**: 
- 오래된 파일 삭제
- 최근 파일 유지

---

### 5. 웹 직접 입력 기능 테스트

#### 5.1 단일 입력 폼 테스트
1. `/input` 페이지 접속
2. 기본급 입력
3. 연장근무단가 권장값 표시 확인
4. 권장값 클릭하여 자동 입력 확인
5. 실시간 미리보기 확인

**예상 결과**: 
- 권장값 자동 계산 및 표시
- 클릭 시 자동 입력
- 실시간 미리보기 업데이트

#### 5.2 다중 입력 폼 테스트
1. `/input/multiple` 페이지 접속
2. 여러 직원 추가
3. 각 직원별 권장값 계산 확인
4. 폼 제출 및 결과 확인

**예상 결과**: 
- 각 직원별 독립적인 권장값 계산
- 정상 제출 및 처리

#### 5.3 실시간 미리보기 테스트
1. 기본급 입력
2. 연장근무시간 입력
3. 상여금 입력
4. 부양가족수 변경

**예상 결과**: 
- 각 입력마다 실시간 업데이트
- 상세 계산 내역 표시

---

### 6. 통합 플로우 테스트

#### 6.1 전체 급여명세서 생성 플로우
1. 파일 업로드 또는 직접 입력
2. 급여 계산
3. 결과 확인
4. 파일 다운로드

**예상 결과**: 
- 모든 단계 정상 작동
- 파일 정상 생성

#### 6.2 에러 복구 테스트
1. 잘못된 입력으로 에러 발생
2. 올바른 입력으로 재시도

**예상 결과**: 
- 에러 메시지 표시
- 재시도 시 정상 작동

---

## 📊 테스트 체크리스트

### 보안
- [ ] 개발 환경 SECRET_KEY 경고 표시
- [ ] 프로덕션 환경 SECRET_KEY 필수 확인
- [ ] 세션 타임아웃 정상 작동

### 에러 처리
- [ ] 400 에러 핸들러 작동
- [ ] 403 에러 핸들러 작동
- [ ] 404 에러 핸들러 작동
- [ ] 500 에러 핸들러 작동
- [ ] 구체적 예외 처리 작동

### 파일 관리
- [ ] 파일 정리 함수 정상 작동
- [ ] 스케줄러 정상 등록
- [ ] 오래된 파일 자동 삭제

### 웹 직접 입력
- [ ] 연장근무단가 권장값 계산
- [ ] 실시간 미리보기 작동
- [ ] 다중 입력 폼 자동 계산

---

## 🚀 테스트 실행 방법

### 단위 테스트 실행
```bash
# 개별 테스트 실행
python tests/test_config.py
python tests/test_cleanup.py
python tests/test_app_init.py
python tests/test_error_handlers.py

# 전체 테스트 실행
python tests/run_all_tests.py
```

### 통합 테스트 실행
1. Flask 앱 실행
   ```bash
   python app.py
   ```

2. 브라우저에서 각 기능 테스트
   - http://localhost:5001
   - http://localhost:5001/input
   - http://localhost:5001/input/multiple

3. 에러 케이스 테스트
   - 잘못된 파일 업로드
   - 존재하지 않는 페이지 접속
   - 권한 없는 작업 시도

---

**작성자**: AI Assistant  
**작성일**: 2025-12-11
