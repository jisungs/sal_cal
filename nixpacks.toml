# Nixpacks 설정 파일 - Railway 빌드 설정
# LibreOffice 및 한글 폰트 설치를 위한 설정

# Python3는 pip를 포함하고 있으므로 별도로 pip를 지정할 필요 없음
[phases.setup]
nixPkgs = ["libreoffice", "python3"]

[phases.install]
cmds = [
  "apt-get update && apt-get install -y libreoffice libreoffice-writer libreoffice-calc libreoffice-impress fonts-nanum fonts-nanum-coding fontconfig || true",
  "mkdir -p /usr/share/fonts/truetype/nanum ~/.fonts /usr/share/fonts/opentype",
  "cp payroll_generator/assets/NanumGothic.ttf /usr/share/fonts/truetype/nanum/ 2>/dev/null || cp 'payroll_generator/assets/나눔 글꼴/나눔고딕/NanumFontSetup_TTF_GOTHIC/NanumGothic.ttf' /usr/share/fonts/truetype/nanum/ 2>/dev/null || true",
  "cp payroll_generator/assets/NanumGothic.ttf ~/.fonts/ 2>/dev/null || cp 'payroll_generator/assets/나눔 글꼴/나눔고딕/NanumFontSetup_TTF_GOTHIC/NanumGothic.ttf' ~/.fonts/ 2>/dev/null || true",
  "fc-cache -fv --force",
  "fc-list | grep -i nanum || echo '폰트 확인 중...'"
]

# Python 패키지 설치는 Nixpacks가 자동으로 처리합니다
# requirements.txt 파일이 있으면 Nixpacks가 자동으로 Python 환경을 설정하고
# [phases.build] 단계에서 pip install을 실행합니다
# 따라서 [phases.install]에서 수동으로 pip install을 실행할 필요가 없습니다

